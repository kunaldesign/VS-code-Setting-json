(()=>{var e,t,n,r={7775:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelServiceProperties=t.TunnelProtocol=t.TunnelHeaderNames=t.TunnelEndpoint=t.TunnelConnectionMode=t.TunnelAccessScopes=t.TunnelAccessControlEntryType=t.TunnelAccessControl=void 0;var r=n(5580);Object.defineProperty(t,"TunnelAccessControl",{enumerable:!0,get:function(){return r.TunnelAccessControl}});var o=n(7334);Object.defineProperty(t,"TunnelAccessControlEntryType",{enumerable:!0,get:function(){return o.TunnelAccessControlEntryType}});var s=n(7321);Object.defineProperty(t,"TunnelAccessScopes",{enumerable:!0,get:function(){return s.TunnelAccessScopes}});var i=n(6655);Object.defineProperty(t,"TunnelConnectionMode",{enumerable:!0,get:function(){return i.TunnelConnectionMode}});var a=n(8825);Object.defineProperty(t,"TunnelEndpoint",{enumerable:!0,get:function(){return a.TunnelEndpoint}});var c=n(1036);Object.defineProperty(t,"TunnelHeaderNames",{enumerable:!0,get:function(){return c.TunnelHeaderNames}});var u=n(9019);Object.defineProperty(t,"TunnelProtocol",{enumerable:!0,get:function(){return u.TunnelProtocol}});var l=n(9579);Object.defineProperty(t,"TunnelServiceProperties",{enumerable:!0,get:function(){return l.TunnelServiceProperties}})},5580:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelAccessControl=void 0;const r=n(5402);t.TunnelAccessControl={validateScopes:r.validateScopes}},7334:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelAccessControlEntryType=void 0,(n=t.TunnelAccessControlEntryType||(t.TunnelAccessControlEntryType={})).None="None",n.Anonymous="Anonymous",n.Users="Users",n.Groups="Groups",n.Organizations="Organizations",n.Repositories="Repositories",n.PublicKeys="PublicKeys",n.IPAddressRanges="IPAddressRanges"},5402:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateScopes=void 0;const r=n(7321),o=[r.TunnelAccessScopes.Manage,r.TunnelAccessScopes.Host,r.TunnelAccessScopes.Inspect,r.TunnelAccessScopes.Connect];t.validateScopes=function(e,t){if(!Array.isArray(e))throw new TypeError("A scopes array was expected.");e.forEach((e=>{if(!e)throw new Error("Tunnel access scopes include a null/empty item.");if(!o.includes(e))throw new Error("Invalid tunnel access scope: "+e)})),Array.isArray(t)&&e.forEach((e=>{if(!t.includes(e))throw new Error("Tunnel access scope is invalid for current request: scope")}))}},7321:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelAccessScopes=void 0,(n=t.TunnelAccessScopes||(t.TunnelAccessScopes={})).Create="create",n.Manage="manage",n.Host="host",n.Inspect="inspect",n.Connect="connect"},6655:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelConnectionMode=void 0,(n=t.TunnelConnectionMode||(t.TunnelConnectionMode={})).LocalNetwork="LocalNetwork",n.TunnelRelay="TunnelRelay"},8825:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelEndpoint=t.portToken=void 0,t.portToken="{port}";const r=n(8941);t.TunnelEndpoint={portToken:t.portToken,getPortUri:r.getPortUri,getPortSshCommand:r.getPortSshCommand}},8941:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPortSshCommand=t.getPortUri=void 0;const r=n(8825);t.getPortUri=function(e,t){if(!e)throw new TypeError("A tunnel endpoint is required.");if("number"==typeof t&&e.portUriFormat)return e.portUriFormat.replace(r.portToken,t.toString())},t.getPortSshCommand=function(e,t){if(!e)throw new TypeError("A tunnel endpoint is required.");if("number"==typeof t&&e.portSshCommandFormat)return e.portSshCommandFormat.replace(r.portToken,t.toString())}},1036:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelHeaderNames=void 0,(n=t.TunnelHeaderNames||(t.TunnelHeaderNames={})).XTunnelAuthorization="X-Tunnel-Authorization",n.XRequestID="X-Request-ID",n.XGithubSshKey="X-Github-Ssh-Key"},9019:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelProtocol=void 0,(n=t.TunnelProtocol||(t.TunnelProtocol={})).Auto="auto",n.Tcp="tcp",n.Udp="udp",n.Ssh="ssh",n.Rdp="rdp",n.Http="http",n.Https="https"},9579:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelServiceProperties=t.nonProdGitHubAppClientId=t.prodGitHubAppClientId=t.devThirdPartyAppId=t.ppeThirdPartyAppId=t.prodThirdPartyAppId=t.nonProdFirstPartyAppId=t.prodFirstPartyAppId=t.devDnsName=t.ppeDnsName=t.prodDnsName=void 0,t.prodDnsName="global.rel.tunnels.api.visualstudio.com",t.ppeDnsName="global.rel.tunnels.ppe.api.visualstudio.com",t.devDnsName="global.ci.tunnels.dev.api.visualstudio.com",t.prodFirstPartyAppId="46da2f7e-b5ef-422a-88d4-2a7f9de6a0b2",t.nonProdFirstPartyAppId="54c45752-bacd-424a-b928-652f3eca2b18",t.prodThirdPartyAppId="ce65d243-a913-4cae-a7dd-cb52e9f77647",t.ppeThirdPartyAppId="544167a6-f431-4518-aac6-2fd50071928e",t.devThirdPartyAppId="a118c979-0249-44bb-8f95-eb0457127aeb",t.prodGitHubAppClientId="Iv1.e7b89e013f801f03",t.nonProdGitHubAppClientId="Iv1.b231c327f1eaa229";const r=n(8925);t.TunnelServiceProperties={production:r.production,staging:r.staging,development:r.development,environment:r.environment}},8925:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.environment=t.development=t.staging=t.production=void 0;const r=n(9579);t.production={serviceUri:`https://${r.prodDnsName}/`,serviceAppId:r.prodFirstPartyAppId,serviceInternalAppId:r.prodThirdPartyAppId,gitHubAppClientId:r.prodGitHubAppClientId},t.staging={serviceUri:`https://${r.ppeDnsName}/`,serviceAppId:r.nonProdFirstPartyAppId,serviceInternalAppId:r.ppeThirdPartyAppId,gitHubAppClientId:r.nonProdGitHubAppClientId},t.development={serviceUri:`https://${r.devDnsName}/`,serviceAppId:r.nonProdFirstPartyAppId,serviceInternalAppId:r.devThirdPartyAppId,gitHubAppClientId:r.nonProdGitHubAppClientId},t.environment=function(e){if(!e)throw new Error(`Invalid argument: ${e}`);switch(e.toLowerCase()){case"prod":case"production":return t.production;case"ppe":case"preprod":return t.staging;case"dev":case"development":return t.development;default:throw new Error(`Invalid service environment: ${e}`)}}},1928:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(1037),t),o(n(8906),t),o(n(9591),t),o(n(2160),t)},2160:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelAccessTokenProperties=void 0;class n{toString(){let e="";return this.tunnelId&&(e+="tunnel=",e+=this.tunnelId,this.clusterId&&(e+=".",e+=this.clusterId)),"number"==typeof this.tunnelPort&&(e.length>0&&(e+=", "),e+="port=",e+=this.tunnelPort),this.scp&&(e.length>0&&(e+=", "),e+=`scopes=[${this.scp.split(" ").join(", ")}]`),this.iss&&(e.length>0&&(e+=", "),e+="issuer=",e+=this.iss),this.exp&&(e.length>0&&(e+=", "),e+="expiration=",e+=new Date(1e3*this.exp).toString().replace(".000Z","Z")),e}static validateTokenExpiration(e){const t=n.tryParse(e);if("number"==typeof(null==t?void 0:t.exp)&&new Date(1e3*t.exp)<new Date)throw new Error("The access token is expired: "+t)}static tryParse(e){if("string"!=typeof e)throw new TypeError("Token string expected.");const t=e.split(".");if(3!==t.length)return null;const r=n.base64UrlDecode(t[1]);if(!r)return null;try{const e=new n;return Object.assign(e,JSON.parse(r)),e}catch(e){return null}}static base64UrlDecode(e){for(e=e.replace("-","+");e.length%4!=0;)e+="=";try{return atob(e)}catch(e){return null}}}t.TunnelAccessTokenProperties=n},8906:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelAuthenticationSchemes=void 0;class n{}t.TunnelAuthenticationSchemes=n,n.aad="aad",n.github="github",n.tunnel="tunnel"},1037:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelManagementHttpClient=void 0;const r=n(7775),o=n(8906),s=n(2160),i=n(1845),a=n(4206),c="/api/v1/tunnels",u="/ports",l="Authorization";function h(e,t){var n,r;return(null!==(n=e.portNumber)&&void 0!==n?n:Number.MAX_SAFE_INTEGER)-(null!==(r=t.portNumber)&&void 0!==r?r:Number.MAX_SAFE_INTEGER)}function d(e){return"string"==typeof e?new Date(Date.parse(e)):e}function p(e){e&&(e.created=d(e.created),e.status&&(e.status.lastHostConnectionTime=d(e.status.lastHostConnectionTime),e.status.lastClientConnectionTime=d(e.status.lastClientConnectionTime)))}function f(e){e&&e.status&&(e.status.lastClientConnectionTime=d(e.status.lastClientConnectionTime))}const m=[r.TunnelAccessScopes.Manage],g=[r.TunnelAccessScopes.Host],y=[r.TunnelAccessScopes.Manage,r.TunnelAccessScopes.Host],v=[r.TunnelAccessScopes.Manage,r.TunnelAccessScopes.Host,r.TunnelAccessScopes.Connect];class w{constructor(e,t,n,o){var s;if(this.httpsAgent=o,this.trace=e=>{},!e)throw new TypeError("User agent must be provided.");if(Array.isArray(e)){if(0===e.length)throw new TypeError("User agents cannot be empty.");let t="";e.forEach((e=>{var n;if("string"!=typeof e){if(!e.name)throw new TypeError("Invalid user agent. The name must be provided.");if("string"!=typeof e.name)throw new TypeError("Invalid user agent. The name must be a string.");if(e.version&&"string"!=typeof e.version)throw new TypeError("Invalid user agent. The version must be a string.");t=`${t}${e.name}/${null!==(n=e.version)&&void 0!==n?n:"unknown"} `}else t=`${t}${e} `})),this.userAgents=t.trim()}else if("string"!=typeof e){if(!e.name)throw new TypeError("Invalid user agent. The name must be provided.");if("string"!=typeof e.name)throw new TypeError("Invalid user agent. The name must be a string.");if(e.version&&"string"!=typeof e.version)throw new TypeError("Invalid user agent. The version must be a string.");this.userAgents=`${e.name}/${null!==(s=e.version)&&void 0!==s?s:"unknown"}`}else this.userAgents=e;this.userTokenCallback=null!=t?t:()=>Promise.resolve(null),n||(n=r.TunnelServiceProperties.production.serviceUri);const i=new URL(n);if(!i||"/"!==i.pathname)throw new TypeError(`Invalid tunnel service URI: ${n}`);this.baseAddress=n}async listTunnels(e,t,n){const r=[e?null:"global=true",t?`domain=${t}`:null].filter((e=>!!e)).join("&"),o=this.buildUri(e,c,n,r),s=await this.getAxiosRequestConfig(void 0,n,v),i=await this.request("GET",o,void 0,s);return i.forEach(p),i}async getTunnel(e,t){const n=this.buildUriForTunnel(e,t),r=await this.getAxiosRequestConfig(e,t,v),o=await this.request("GET",n,void 0,r);return p(o),o}async createTunnel(e,t){if(e.tunnelId)throw new Error("An ID may not be specified when creating a tunnel.");const n=this.buildUri(e.clusterId,c,t),r=await this.getAxiosRequestConfig(e,t,m);e=this.convertTunnelForRequest(e);const o=await this.request("POST",n,e,r);return p(o),o}async updateTunnel(e,t){const n=this.buildUriForTunnel(e,t),r=await this.getAxiosRequestConfig(e,t,m),o=await this.request("PUT",n,this.convertTunnelForRequest(e),r);return(null==t?void 0:t.tokenScopes)||(o.accessTokens=e.accessTokens),p(o),o}async deleteTunnel(e,t){const n=this.buildUriForTunnel(e,t),r=await this.getAxiosRequestConfig(e,t,m);return await this.request("DELETE",n,void 0,r)}async updateTunnelEndpoint(e,t,n){const r=this.buildUriForTunnel(e,n,`/endpoints/${t.hostId}/${t.connectionMode}`),o=await this.getAxiosRequestConfig(e,n,g),s=await this.request("PUT",r,t,o);return e.endpoints&&(e.endpoints=e.endpoints.filter((e=>e.hostId!==t.hostId||e.connectionMode!==t.connectionMode)).concat(s)),s}async deleteTunnelEndpoints(e,t,n,r){let o=null==n?`/endpoints/${t}`:`/endpoints/${t}/${n}`;const s=this.buildUriForTunnel(e,r,o),i=await this.getAxiosRequestConfig(e,r,g),a=await this.request("DELETE",s,void 0,i);return a&&e.endpoints&&(e.endpoints=e.endpoints.filter((e=>e.hostId!==t||e.connectionMode!==n))),a}async listTunnelPorts(e,t){const n=this.buildUriForTunnel(e,t,u),r=await this.getAxiosRequestConfig(e,t,v),o=await this.request("GET",n,void 0,r);return o.forEach(f),o}async getTunnelPort(e,t,n){const r=this.buildUriForTunnel(e,n,`/ports/${t}`),o=await this.getAxiosRequestConfig(e,n,v),s=await this.request("GET",r,void 0,o);return f(s),s}async createTunnelPort(e,t,n){const r=this.buildUriForTunnel(e,n,u),o=await this.getAxiosRequestConfig(e,n,y);t=this.convertTunnelPortForRequest(e,t);const s=await this.request("POST",r,t,o);return e.ports&&(e.ports=e.ports.filter((e=>e.portNumber!==t.portNumber)).concat(s).sort(h)),f(s),s}async updateTunnelPort(e,t,n){if(t.clusterId&&e.clusterId&&t.clusterId!==e.clusterId)throw new Error("Tunnel port cluster ID is not consistent.");let r=t.portNumber;const o=this.buildUriForTunnel(e,n,`/ports/${r}`),s=await this.getAxiosRequestConfig(e,n,y),i=await this.request("PUT",o,this.convertTunnelPortForRequest(e,t),s);return e.ports&&(e.ports=e.ports.filter((e=>e.portNumber!==t.portNumber)).concat(i).sort(h)),(null==n?void 0:n.tokenScopes)||(i.accessTokens=t.accessTokens),f(i),i}async deleteTunnelPort(e,t,n){const r=this.buildUriForTunnel(e,n,`/ports/${t}`),o=await this.getAxiosRequestConfig(e,n,y),s=await this.request("DELETE",r,void 0,o);return s&&e.ports&&(e.ports=e.ports.filter((e=>e.portNumber!==t)).sort(h)),s}getResponseErrorMessage(e){var t,n,r,o;let s="";if(null===(t=e.response)||void 0===t?void 0:t.data){let t=e.response.data;(t.title||t.detail)&&(s=`Tunnel service error: ${t.title}`,t.detail&&(s+=" "+t.detail),t.errors&&(s+=JSON.stringify(t.errors)))}s||(s=(null==e?void 0:e.response)?`Tunnel service returned status code: ${e.response.status} ${e.response.statusText}`:null!==(r=null!==(n=null==e?void 0:e.message)&&void 0!==n?n:e)&&void 0!==r?r:"Unknown tunnel service request error.");const i="VsSaaS-Request-Id";return(null===(o=e.response)||void 0===o?void 0:o.headers)&&e.response.headers[i]&&(s+=`\nRequest ID: ${e.response.headers[i]}`),s}buildUri(e,t,n,r){let o=this.baseAddress;if(e){const t=new URL(o),n=parseInt(t.port,10);if("localhost"===t.hostname||t.hostname.startsWith(`${e}.`)){if("https:"===t.protocol&&e.startsWith("localhost")&&n%10>0){const r=parseInt(e.substring("localhost".length),10);r>0&&r<10&&(t.port=(n-n%10+r).toString(),o=t.toString())}}else t.hostname=`${e}.${t.hostname}`.replace("global.",""),o=t.toString()}o=`${o.replace(/\/$/,"")}${t}`;let s=this.tunnelRequestOptionsToQueryString(n,r);return s&&(o+=`?${s}`),o}buildUriForTunnel(e,t,n,r){let o="";if(e.clusterId&&e.tunnelId)o=`/api/v1/tunnels/${e.tunnelId}`;else{if(!e.name)throw new Error("Tunnel object must include either a name or tunnel ID and cluster ID.");o=`/api/v1/tunnels/${e.name}`}return this.buildUri(e.clusterId,o+(n||""),t,r)}async getAxiosRequestConfig(e,t,n){let r={};if(t&&t.accessToken&&(s.TunnelAccessTokenProperties.validateTokenExpiration(t.accessToken),r.Authorization=`${o.TunnelAuthenticationSchemes.tunnel} ${t.accessToken}`),!(l in r)&&this.userTokenCallback){let e=await this.userTokenCallback();e&&(r.Authorization=e)}if(!(l in r)&&(null==e?void 0:e.accessTokens))for(let t of null!=n?n:[]){const n=e.accessTokens[t];if(n){s.TunnelAccessTokenProperties.validateTokenExpiration(n),r.Authorization=`${o.TunnelAuthenticationSchemes.tunnel} ${n}`;break}}const a=e=>{if(e)for(let[t,n]of Object.entries(e))r[t]=n};a(this.additionalRequestHeaders),a(null==t?void 0:t.additionalHeaders);const c=r["User-Agent"]?r["User-Agent"]+" ":"";r["User-Agent"]=`${c}${this.userAgents} ${i.tunnelSdkUserAgent}`;let u=Object.assign({headers:r},this.httpsAgent&&{httpsAgent:this.httpsAgent});return!1===(null==t?void 0:t.followRedirects)&&(u.maxRedirects=0),u}convertTunnelForRequest(e){var t;return{name:e.name,domain:e.domain,description:e.description,tags:e.tags,options:e.options,accessControl:e.accessControl?{entries:e.accessControl.entries.filter((e=>!e.isInherited))}:void 0,endpoints:e.endpoints,ports:null===(t=e.ports)||void 0===t?void 0:t.map((t=>this.convertTunnelPortForRequest(e,t)))}}convertTunnelPortForRequest(e,t){if(t.clusterId&&e.clusterId&&t.clusterId!==e.clusterId)throw new Error("Tunnel port cluster ID does not match tunnel.");if(t.tunnelId&&e.tunnelId&&t.tunnelId!==e.tunnelId)throw new Error("Tunnel port tunnel ID does not match tunnel.");return{portNumber:t.portNumber,protocol:t.protocol,options:t.options,accessControl:t.accessControl?{entries:t.accessControl.entries.filter((e=>!e.isInherited))}:void 0}}tunnelRequestOptionsToQueryString(e,t){let n={};const o=[];return e&&(e.includePorts&&(n.includePorts=["true"]),e.scopes&&(r.TunnelAccessControl.validateScopes(e.scopes),n.scopes=e.scopes),e.tokenScopes&&(r.TunnelAccessControl.validateScopes(e.tokenScopes),n.tokenScopes=e.tokenScopes),e.forceRename&&(n.forceRename=["true"]),e.tags&&(n.tags=e.tags,e.requireAllTags&&(n.allTags=["true"])),o.push(...Object.keys(n).map((e=>`${e}=${n[e].map(encodeURIComponent).join(",")}`)))),t&&o.push(t),o.join("&")}async request(e,t,n,r){this.trace(`${e} ${t}`),this.traceHeaders(r.headers),this.traceContent(n);const o=e=>{this.trace(`${e.status} ${e.statusText}`),this.traceHeaders(e.headers),this.traceContent(e.data)};try{r.url=t,r.method=e,r.data=n;let s=await a.default.request(r);return o(s),s.data}catch(e){if(!(e instanceof Error&&e.isAxiosError))throw e;const t=e;throw t.response&&o(t.response),t.message=this.getResponseErrorMessage(t),delete t.request,t.response&&(delete t.config.httpAgent,delete t.config.httpsAgent,delete t.response.request),t}}traceHeaders(e){for(let[t,n]of Object.entries(e)){if("Authorization"===t)return void this.traceAuthorizationHeader(t,n);this.trace(`${t}: ${null!=n?n:""}`)}}traceAuthorizationHeader(e,t){if("string"!=typeof t)return;const n=t.indexOf(" ");if(n<0)return void this.trace(`${e}: [${t.length}]`);const r=t.substring(0,n),i=t.substring(n+1);if(r.toLowerCase()===o.TunnelAuthenticationSchemes.tunnel.toLowerCase()){const t=s.TunnelAccessTokenProperties.tryParse(i);if(t)return void this.trace(`${e}: ${r} <${t}>`)}this.trace(`${e}: ${r} <token>`)}traceContent(e){"object"==typeof e&&(e=JSON.stringify(e,void 0,"  ")),"string"==typeof e&&this.trace(w.replaceTokensInContent(e))}static replaceTokensInContent(e){var t;const n=/"(eyJ[a-zA-z0-9\-_]+\.[a-zA-z0-9\-_]+\.[a-zA-z0-9\-_]+)"/;let r=n.exec(e);for(;r;){let o=r[1];const i=s.TunnelAccessTokenProperties.tryParse(o);o=null!==(t=null==i?void 0:i.toString())&&void 0!==t?t:"token",e=e.substring(0,r.index+1)+"<"+o+">"+e.substring(r.index+r[0].length-1),r=n.exec(e)}return e}}t.TunnelManagementHttpClient=w},9591:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1845:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tunnelSdkUserAgent=void 0;const r=n(7564).version;t.tunnelSdkUserAgent=`Visual-Studio-Tunnel-Service-SDK/${r}`},4206:(e,t,n)=>{e.exports=n(8057)},8298:(e,t,n)=>{"use strict";var r=n(7485),o=n(4570),s=n(574),i=n(581),a=n(3685),c=n(5687),u=n(4095).http,l=n(4095).https,h=n(7310),d=n(9796),p=n(9843),f=n(8524),m=n(9953),g=/https:?/;function y(e,t,n){if(e.hostname=t.host,e.host=t.host,e.port=t.port,e.path=n,t.auth){var r=Buffer.from(t.auth.username+":"+t.auth.password,"utf8").toString("base64");e.headers["Proxy-Authorization"]="Basic "+r}e.beforeRedirect=function(e){e.headers.host=e.host,y(e,t,e.href)}}e.exports=function(e){return new Promise((function(t,n){var v=function(e){t(e)},w=function(e){n(e)},b=e.data,T=e.headers;if("User-Agent"in T||"user-agent"in T?T["User-Agent"]||T["user-agent"]||(delete T["User-Agent"],delete T["user-agent"]):T["User-Agent"]="axios/"+p.version,b&&!r.isStream(b)){if(Buffer.isBuffer(b));else if(r.isArrayBuffer(b))b=Buffer.from(new Uint8Array(b));else{if(!r.isString(b))return w(f("Data after transformation must be a string, an ArrayBuffer, a Buffer, or a Stream",e));b=Buffer.from(b,"utf-8")}T["Content-Length"]=b.length}var C=void 0;e.auth&&(C=(e.auth.username||"")+":"+(e.auth.password||""));var x=s(e.baseURL,e.url),E=h.parse(x),S=E.protocol||"http:";if(!C&&E.auth){var A=E.auth.split(":");C=(A[0]||"")+":"+(A[1]||"")}C&&delete T.Authorization;var I=g.test(S),R=I?e.httpsAgent:e.httpAgent,U={path:i(E.path,e.params,e.paramsSerializer).replace(/^\?/,""),method:e.method.toUpperCase(),headers:T,agent:R,agents:{http:e.httpAgent,https:e.httpsAgent},auth:C};e.socketPath?U.socketPath=e.socketPath:(U.hostname=E.hostname,U.port=E.port);var _,k=e.proxy;if(!k&&!1!==k){var P=S.slice(0,-1)+"_proxy",O=process.env[P]||process.env[P.toUpperCase()];if(O){var F=h.parse(O),j=process.env.no_proxy||process.env.NO_PROXY,B=!0;if(j&&(B=!j.split(",").map((function(e){return e.trim()})).some((function(e){return!!e&&("*"===e||"."===e[0]&&E.hostname.substr(E.hostname.length-e.length)===e||E.hostname===e)}))),B&&(k={host:F.hostname,port:F.port,protocol:F.protocol},F.auth)){var N=F.auth.split(":");k.auth={username:N[0],password:N[1]}}}}k&&(U.headers.host=E.hostname+(E.port?":"+E.port:""),y(U,k,S+"//"+E.hostname+(E.port?":"+E.port:"")+U.path));var q=I&&(!k||g.test(k.protocol));e.transport?_=e.transport:0===e.maxRedirects?_=q?c:a:(e.maxRedirects&&(U.maxRedirects=e.maxRedirects),_=q?l:u),e.maxBodyLength>-1&&(U.maxBodyLength=e.maxBodyLength);var M=_.request(U,(function(t){if(!M.aborted){var n=t,s=t.req||M;if(204!==t.statusCode&&"HEAD"!==s.method&&!1!==e.decompress)switch(t.headers["content-encoding"]){case"gzip":case"compress":case"deflate":n=n.pipe(d.createUnzip()),delete t.headers["content-encoding"]}var i={status:t.statusCode,statusText:t.statusMessage,headers:t.headers,config:e,request:s};if("stream"===e.responseType)i.data=n,o(v,w,i);else{var a=[],c=0;n.on("data",(function(t){a.push(t),c+=t.length,e.maxContentLength>-1&&c>e.maxContentLength&&(n.destroy(),w(f("maxContentLength size of "+e.maxContentLength+" exceeded",e,null,s)))})),n.on("error",(function(t){M.aborted||w(m(t,e,null,s))})),n.on("end",(function(){var t=Buffer.concat(a);"arraybuffer"!==e.responseType&&(t=t.toString(e.responseEncoding),e.responseEncoding&&"utf8"!==e.responseEncoding||(t=r.stripBOM(t))),i.data=t,o(v,w,i)}))}}}));if(M.on("error",(function(t){M.aborted&&"ERR_FR_TOO_MANY_REDIRECTS"!==t.code||w(m(t,e,null,M))})),e.timeout){var L=parseInt(e.timeout,10);if(isNaN(L))return void w(f("error trying to parse `config.timeout` to int",e,"ERR_PARSE_TIMEOUT",M));M.setTimeout(L,(function(){M.abort(),w(f("timeout of "+L+"ms exceeded",e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",M))}))}e.cancelToken&&e.cancelToken.promise.then((function(e){M.aborted||(M.abort(),w(e))})),r.isStream(b)?b.on("error",(function(t){w(m(t,e,null,M))})).pipe(M):M.end(b)}))}},4387:(e,t,n)=>{"use strict";var r=n(7485),o=n(4570),s=n(2940),i=n(581),a=n(574),c=n(3845),u=n(8338),l=n(8524);e.exports=function(e){return new Promise((function(t,n){var h=e.data,d=e.headers,p=e.responseType;r.isFormData(h)&&delete d["Content-Type"];var f=new XMLHttpRequest;if(e.auth){var m=e.auth.username||"",g=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";d.Authorization="Basic "+btoa(m+":"+g)}var y=a(e.baseURL,e.url);function v(){if(f){var r="getAllResponseHeaders"in f?c(f.getAllResponseHeaders()):null,s={data:p&&"text"!==p&&"json"!==p?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:r,config:e,request:f};o(t,n,s),f=null}}if(f.open(e.method.toUpperCase(),i(y,e.params,e.paramsSerializer),!0),f.timeout=e.timeout,"onloadend"in f?f.onloadend=v:f.onreadystatechange=function(){f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))&&setTimeout(v)},f.onabort=function(){f&&(n(l("Request aborted",e,"ECONNABORTED",f)),f=null)},f.onerror=function(){n(l("Network Error",e,null,f)),f=null},f.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(l(t,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",f)),f=null},r.isStandardBrowserEnv()){var w=(e.withCredentials||u(y))&&e.xsrfCookieName?s.read(e.xsrfCookieName):void 0;w&&(d[e.xsrfHeaderName]=w)}"setRequestHeader"in f&&r.forEach(d,(function(e,t){void 0===h&&"content-type"===t.toLowerCase()?delete d[t]:f.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(f.withCredentials=!!e.withCredentials),p&&"json"!==p&&(f.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&f.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){f&&(f.abort(),n(e),f=null)})),h||(h=null),f.send(h)}))}},8057:(e,t,n)=>{"use strict";var r=n(7485),o=n(875),s=n(5029),i=n(4941);function a(e){var t=new s(e),n=o(s.prototype.request,t);return r.extend(n,s.prototype,t),r.extend(n,t),n}var c=a(n(3141));c.Axios=s,c.create=function(e){return a(i(c.defaults,e))},c.Cancel=n(7132),c.CancelToken=n(4603),c.isCancel=n(1475),c.all=function(e){return Promise.all(e)},c.spread=n(5739),c.isAxiosError=n(5835),e.exports=c,e.exports.default=c},7132:e=>{"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},4603:(e,t,n)=>{"use strict";var r=n(7132);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var e;return{token:new o((function(t){e=t})),cancel:e}},e.exports=o},1475:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},5029:(e,t,n)=>{"use strict";var r=n(7485),o=n(581),s=n(8096),i=n(5009),a=n(4941),c=n(6144),u=c.validators;function l(e){this.defaults=e,this.interceptors={request:new s,response:new s}}l.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&c.assertOptions(t,{silentJSONParsing:u.transitional(u.boolean,"1.0.0"),forcedJSONParsing:u.transitional(u.boolean,"1.0.0"),clarifyTimeoutError:u.transitional(u.boolean,"1.0.0")},!1);var n=[],r=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(r=r&&t.synchronous,n.unshift(t.fulfilled,t.rejected))}));var o,s=[];if(this.interceptors.response.forEach((function(e){s.push(e.fulfilled,e.rejected)})),!r){var l=[i,void 0];for(Array.prototype.unshift.apply(l,n),l=l.concat(s),o=Promise.resolve(e);l.length;)o=o.then(l.shift(),l.shift());return o}for(var h=e;n.length;){var d=n.shift(),p=n.shift();try{h=d(h)}catch(e){p(e);break}}try{o=i(h)}catch(e){return Promise.reject(e)}for(;s.length;)o=o.then(s.shift(),s.shift());return o},l.prototype.getUri=function(e){return e=a(this.defaults,e),o(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){l.prototype[e]=function(t,n){return this.request(a(n||{},{method:e,url:t,data:(n||{}).data}))}})),r.forEach(["post","put","patch"],(function(e){l.prototype[e]=function(t,n,r){return this.request(a(r||{},{method:e,url:t,data:n}))}})),e.exports=l},8096:(e,t,n)=>{"use strict";var r=n(7485);function o(){this.handlers=[]}o.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=o},574:(e,t,n)=>{"use strict";var r=n(2642),o=n(2288);e.exports=function(e,t){return e&&!r(t)?o(e,t):t}},8524:(e,t,n)=>{"use strict";var r=n(9953);e.exports=function(e,t,n,o,s){var i=new Error(e);return r(i,t,n,o,s)}},5009:(e,t,n)=>{"use strict";var r=n(7485),o=n(9212),s=n(1475),i=n(3141);function a(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return a(e),e.headers=e.headers||{},e.data=o.call(e,e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||i.adapter)(e).then((function(t){return a(e),t.data=o.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return s(t)||(a(e),t&&t.response&&(t.response.data=o.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},9953:e=>{"use strict";e.exports=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},4941:(e,t,n)=>{"use strict";var r=n(7485);e.exports=function(e,t){t=t||{};var n={},o=["url","method","data"],s=["headers","auth","proxy","params"],i=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],a=["validateStatus"];function c(e,t){return r.isPlainObject(e)&&r.isPlainObject(t)?r.merge(e,t):r.isPlainObject(t)?r.merge({},t):r.isArray(t)?t.slice():t}function u(o){r.isUndefined(t[o])?r.isUndefined(e[o])||(n[o]=c(void 0,e[o])):n[o]=c(e[o],t[o])}r.forEach(o,(function(e){r.isUndefined(t[e])||(n[e]=c(void 0,t[e]))})),r.forEach(s,u),r.forEach(i,(function(o){r.isUndefined(t[o])?r.isUndefined(e[o])||(n[o]=c(void 0,e[o])):n[o]=c(void 0,t[o])})),r.forEach(a,(function(r){r in t?n[r]=c(e[r],t[r]):r in e&&(n[r]=c(void 0,e[r]))}));var l=o.concat(s).concat(i).concat(a),h=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===l.indexOf(e)}));return r.forEach(h,u),n}},4570:(e,t,n)=>{"use strict";var r=n(8524);e.exports=function(e,t,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},9212:(e,t,n)=>{"use strict";var r=n(7485),o=n(3141);e.exports=function(e,t,n){var s=this||o;return r.forEach(n,(function(n){e=n.call(s,e,t)})),e}},3141:(e,t,n)=>{"use strict";var r=n(7485),o=n(1446),s=n(9953),i={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var c,u={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:("undefined"!=typeof XMLHttpRequest?c=n(4387):"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process)&&(c=n(8298)),c),transformRequest:[function(e,t){return o(t,"Accept"),o(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)||t&&"application/json"===t["Content-Type"]?(a(t,"application/json"),function(e,t,n){if(r.isString(e))try{return(0,JSON.parse)(e),r.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional,n=t&&t.silentJSONParsing,o=t&&t.forcedJSONParsing,i=!n&&"json"===this.responseType;if(i||o&&r.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(i){if("SyntaxError"===e.name)throw s(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(e){u.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){u.headers[e]=r.merge(i)})),e.exports=u},875:e=>{"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},581:(e,t,n)=>{"use strict";var r=n(7485);function o(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var s;if(n)s=n(t);else if(r.isURLSearchParams(t))s=t.toString();else{var i=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),i.push(o(t)+"="+o(e))})))})),s=i.join("&")}if(s){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}},2288:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},2940:(e,t,n)=>{"use strict";var r=n(7485);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,o,s,i){var a=[];a.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),r.isString(o)&&a.push("path="+o),r.isString(s)&&a.push("domain="+s),!0===i&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},2642:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},5835:e=>{"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},8338:(e,t,n)=>{"use strict";var r=n(7485);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function o(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=o(window.location.href),function(t){var n=r.isString(t)?o(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},1446:(e,t,n)=>{"use strict";var r=n(7485);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},3845:(e,t,n)=>{"use strict";var r=n(7485),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,s,i={};return e?(r.forEach(e.split("\n"),(function(e){if(s=e.indexOf(":"),t=r.trim(e.substr(0,s)).toLowerCase(),n=r.trim(e.substr(s+1)),t){if(i[t]&&o.indexOf(t)>=0)return;i[t]="set-cookie"===t?(i[t]?i[t]:[]).concat([n]):i[t]?i[t]+", "+n:n}})),i):i}},5739:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},6144:(e,t,n)=>{"use strict";var r=n(9843),o={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){o[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var s={},i=r.version.split(".");function a(e,t){for(var n=t?t.split("."):i,r=e.split("."),o=0;o<3;o++){if(n[o]>r[o])return!0;if(n[o]<r[o])return!1}return!1}o.transitional=function(e,t,n){var o=t&&a(t);function i(e,t){return"[Axios v"+r.version+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,r,a){if(!1===e)throw new Error(i(r," has been removed in "+t));return o&&!s[r]&&(s[r]=!0,console.warn(i(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,r,a)}},e.exports={isOlderVersion:a,assertOptions:function(e,t,n){if("object"!=typeof e)throw new TypeError("options must be an object");for(var r=Object.keys(e),o=r.length;o-- >0;){var s=r[o],i=t[s];if(i){var a=e[s],c=void 0===a||i(a,s,e);if(!0!==c)throw new TypeError("option "+s+" must be "+c)}else if(!0!==n)throw Error("Unknown option "+s)}},validators:o}},7485:(e,t,n)=>{"use strict";var r=n(875),o=Object.prototype.toString;function s(e){return"[object Array]"===o.call(e)}function i(e){return void 0===e}function a(e){return null!==e&&"object"==typeof e}function c(e){if("[object Object]"!==o.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function u(e){return"[object Function]"===o.call(e)}function l(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),s(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:s,isArrayBuffer:function(e){return"[object ArrayBuffer]"===o.call(e)},isBuffer:function(e){return null!==e&&!i(e)&&null!==e.constructor&&!i(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isPlainObject:c,isUndefined:i,isDate:function(e){return"[object Date]"===o.call(e)},isFile:function(e){return"[object File]"===o.call(e)},isBlob:function(e){return"[object Blob]"===o.call(e)},isFunction:u,isStream:function(e){return a(e)&&u(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:l,merge:function e(){var t={};function n(n,r){c(t[r])&&c(n)?t[r]=e(t[r],n):c(n)?t[r]=e({},n):s(n)?t[r]=n.slice():t[r]=n}for(var r=0,o=arguments.length;r<o;r++)l(arguments[r],n);return t},extend:function(e,t,n){return l(t,(function(t,o){e[o]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},6292:(e,t,n)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(o=r))})),t.splice(o,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(9374)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},9374:(e,t,n)=>{e.exports=function(e){function t(e){let n,o,s,i=null;function a(...e){if(!a.enabled)return;const r=a,o=Number(new Date),s=o-(n||o);r.diff=s,r.prev=n,r.curr=o,n=o,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let i=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,o)=>{if("%%"===n)return"%";i++;const s=t.formatters[o];if("function"==typeof s){const t=e[i];n=s.call(r,t),e.splice(i,1),i--}return n})),t.formatArgs.call(r,e),(r.log||t.log).apply(r,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=r,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==i?i:(o!==t.namespaces&&(o=t.namespaces,s=t.enabled(e)),s),set:e=>{i=e}}),"function"==typeof t.init&&t.init(a),a}function r(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(o),...t.skips.map(o).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(8628),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},1241:(e,t,n)=>{"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=n(6292):e.exports=n(4428)},4428:(e,t,n)=>{const r=n(6224),o=n(3837);t.init=function(e){e.inspectOpts={};const n=Object.keys(t.inspectOpts);for(let r=0;r<n.length;r++)e.inspectOpts[n[r]]=t.inspectOpts[n[r]]},t.log=function(...e){return process.stderr.write(o.format(...e)+"\n")},t.formatArgs=function(n){const{namespace:r,useColors:o}=this;if(o){const t=this.color,o="[3"+(t<8?t:"8;5;"+t),s=`  ${o};1m${r} [0m`;n[0]=s+n[0].split("\n").join("\n"+s),n.push(o+"m+"+e.exports.humanize(this.diff)+"[0m")}else n[0]=(t.inspectOpts.hideDate?"":(new Date).toISOString()+" ")+r+" "+n[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):r.isatty(process.stderr.fd)},t.destroy=o.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=n(6974);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const n=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let r=process.env[t];return r=!!/^(yes|on|true|enabled)$/i.test(r)||!/^(no|off|false|disabled)$/i.test(r)&&("null"===r?null:Number(r)),e[n]=r,e}),{}),e.exports=n(9374)(t);const{formatters:s}=e.exports;s.o=function(e){return this.inspectOpts.colors=this.useColors,o.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},s.O=function(e){return this.inspectOpts.colors=this.useColors,o.inspect(e,this.inspectOpts)}},6276:(e,t,n)=>{var r;e.exports=function(){if(!r){try{r=n(1241)("follow-redirects")}catch(e){}"function"!=typeof r&&(r=function(){})}r.apply(null,arguments)}},4095:(e,t,n)=>{var r=n(7310),o=r.URL,s=n(3685),i=n(5687),a=n(2781).Writable,c=n(9491),u=n(6276),l=["abort","aborted","connect","error","socket","timeout"],h=Object.create(null);l.forEach((function(e){h[e]=function(t,n,r){this._redirectable.emit(e,t,n,r)}}));var d=T("ERR_FR_REDIRECTION_FAILURE","Redirected request failed"),p=T("ERR_FR_TOO_MANY_REDIRECTS","Maximum number of redirects exceeded"),f=T("ERR_FR_MAX_BODY_LENGTH_EXCEEDED","Request body larger than maxBodyLength limit"),m=T("ERR_STREAM_WRITE_AFTER_END","write after end");function g(e,t){a.call(this),this._sanitizeOptions(e),this._options=e,this._ended=!1,this._ending=!1,this._redirectCount=0,this._redirects=[],this._requestBodyLength=0,this._requestBodyBuffers=[],t&&this.on("response",t);var n=this;this._onNativeResponse=function(e){n._processResponse(e)},this._performRequest()}function y(e){var t={maxRedirects:21,maxBodyLength:10485760},n={};return Object.keys(e).forEach((function(s){var i=s+":",a=n[i]=e[s],l=t[s]=Object.create(a);Object.defineProperties(l,{request:{value:function(e,s,a){if("string"==typeof e){var l=e;try{e=w(new o(l))}catch(t){e=r.parse(l)}}else o&&e instanceof o?e=w(e):(a=s,s=e,e={protocol:i});return"function"==typeof s&&(a=s,s=null),(s=Object.assign({maxRedirects:t.maxRedirects,maxBodyLength:t.maxBodyLength},e,s)).nativeProtocols=n,c.equal(s.protocol,i,"protocol mismatch"),u("options",s),new g(s,a)},configurable:!0,enumerable:!0,writable:!0},get:{value:function(e,t,n){var r=l.request(e,t,n);return r.end(),r},configurable:!0,enumerable:!0,writable:!0}})})),t}function v(){}function w(e){var t={protocol:e.protocol,hostname:e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,hash:e.hash,search:e.search,pathname:e.pathname,path:e.pathname+e.search,href:e.href};return""!==e.port&&(t.port=Number(e.port)),t}function b(e,t){var n;for(var r in t)e.test(r)&&(n=t[r],delete t[r]);return null==n?void 0:String(n).trim()}function T(e,t){function n(e){Error.captureStackTrace(this,this.constructor),e?(this.message=t+": "+e.message,this.cause=e):this.message=t}return n.prototype=new Error,n.prototype.constructor=n,n.prototype.name="Error ["+e+"]",n.prototype.code=e,n}function C(e){for(var t=0;t<l.length;t++)e.removeListener(l[t],h[l[t]]);e.on("error",v),e.abort()}g.prototype=Object.create(a.prototype),g.prototype.abort=function(){C(this._currentRequest),this.emit("abort")},g.prototype.write=function(e,t,n){if(this._ending)throw new m;if(!("string"==typeof e||"object"==typeof e&&"length"in e))throw new TypeError("data should be a string, Buffer or Uint8Array");"function"==typeof t&&(n=t,t=null),0!==e.length?this._requestBodyLength+e.length<=this._options.maxBodyLength?(this._requestBodyLength+=e.length,this._requestBodyBuffers.push({data:e,encoding:t}),this._currentRequest.write(e,t,n)):(this.emit("error",new f),this.abort()):n&&n()},g.prototype.end=function(e,t,n){if("function"==typeof e?(n=e,e=t=null):"function"==typeof t&&(n=t,t=null),e){var r=this,o=this._currentRequest;this.write(e,t,(function(){r._ended=!0,o.end(null,null,n)})),this._ending=!0}else this._ended=this._ending=!0,this._currentRequest.end(null,null,n)},g.prototype.setHeader=function(e,t){this._options.headers[e]=t,this._currentRequest.setHeader(e,t)},g.prototype.removeHeader=function(e){delete this._options.headers[e],this._currentRequest.removeHeader(e)},g.prototype.setTimeout=function(e,t){var n=this;function r(t){t.setTimeout(e),t.removeListener("timeout",t.destroy),t.addListener("timeout",t.destroy)}function o(t){n._timeout&&clearTimeout(n._timeout),n._timeout=setTimeout((function(){n.emit("timeout"),s()}),e),r(t)}function s(){n._timeout&&(clearTimeout(n._timeout),n._timeout=null),n.removeListener("abort",s),n.removeListener("error",s),n.removeListener("response",s),t&&n.removeListener("timeout",t),n.socket||n._currentRequest.removeListener("socket",o)}return t&&this.on("timeout",t),this.socket?o(this.socket):this._currentRequest.once("socket",o),this.on("socket",r),this.on("abort",s),this.on("error",s),this.on("response",s),this},["flushHeaders","getHeader","setNoDelay","setSocketKeepAlive"].forEach((function(e){g.prototype[e]=function(t,n){return this._currentRequest[e](t,n)}})),["aborted","connection","socket"].forEach((function(e){Object.defineProperty(g.prototype,e,{get:function(){return this._currentRequest[e]}})})),g.prototype._sanitizeOptions=function(e){if(e.headers||(e.headers={}),e.host&&(e.hostname||(e.hostname=e.host),delete e.host),!e.pathname&&e.path){var t=e.path.indexOf("?");t<0?e.pathname=e.path:(e.pathname=e.path.substring(0,t),e.search=e.path.substring(t))}},g.prototype._performRequest=function(){var e=this._options.protocol,t=this._options.nativeProtocols[e];if(t){if(this._options.agents){var n=e.slice(0,-1);this._options.agent=this._options.agents[n]}var o=this._currentRequest=t.request(this._options,this._onNativeResponse);this._currentUrl=r.format(this._options),o._redirectable=this;for(var s=0;s<l.length;s++)o.on(l[s],h[l[s]]);if(this._isRedirect){var i=0,a=this,c=this._requestBodyBuffers;!function e(t){if(o===a._currentRequest)if(t)a.emit("error",t);else if(i<c.length){var n=c[i++];o.finished||o.write(n.data,n.encoding,e)}else a._ended&&o.end()}()}}else this.emit("error",new TypeError("Unsupported protocol "+e))},g.prototype._processResponse=function(e){var t=e.statusCode;this._options.trackRedirects&&this._redirects.push({url:this._currentUrl,headers:e.headers,statusCode:t});var n=e.headers.location;if(!n||!1===this._options.followRedirects||t<300||t>=400)return e.responseUrl=this._currentUrl,e.redirects=this._redirects,this.emit("response",e),void(this._requestBodyBuffers=[]);if(C(this._currentRequest),e.destroy(),++this._redirectCount>this._options.maxRedirects)this.emit("error",new p);else{var o,s=this._options.beforeRedirect;s&&(o=Object.assign({Host:e.req.getHeader("host")},this._options.headers));var i=this._options.method;((301===t||302===t)&&"POST"===this._options.method||303===t&&!/^(?:GET|HEAD)$/.test(this._options.method))&&(this._options.method="GET",this._requestBodyBuffers=[],b(/^content-/i,this._options.headers));var a,c=b(/^host$/i,this._options.headers),l=r.parse(this._currentUrl),h=c||l.host,f=/^\w+:/.test(n)?this._currentUrl:r.format(Object.assign(l,{host:h}));try{a=r.resolve(f,n)}catch(e){return void this.emit("error",new d(e))}u("redirecting to",a),this._isRedirect=!0;var m=r.parse(a);if(Object.assign(this._options,m),(m.protocol!==l.protocol&&"https:"!==m.protocol||m.host!==h&&!function(e,t){const n=e.length-t.length-1;return n>0&&"."===e[n]&&e.endsWith(t)}(m.host,h))&&b(/^(?:authorization|cookie)$/i,this._options.headers),"function"==typeof s){var g={headers:e.headers,statusCode:t},y={url:f,method:i,headers:o};try{s(this._options,g,y)}catch(e){return void this.emit("error",e)}this._sanitizeOptions(this._options)}try{this._performRequest()}catch(e){this.emit("error",new d(e))}}},e.exports=y({http:s,https:i}),e.exports.wrap=y},1875:e=>{"use strict";e.exports=(e,t)=>{t=t||process.argv;const n=e.startsWith("-")?"":1===e.length?"-":"--",r=t.indexOf(n+e),o=t.indexOf("--");return-1!==r&&(-1===o||r<o)}},8628:e=>{var t=1e3,n=60*t,r=60*n,o=24*r;function s(e,t,n,r){var o=t>=1.5*n;return Math.round(e/n)+" "+r+(o?"s":"")}e.exports=function(e,i){i=i||{};var a,c,u=typeof e;if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(s){var i=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*i;case"weeks":case"week":case"w":return 6048e5*i;case"days":case"day":case"d":return i*o;case"hours":case"hour":case"hrs":case"hr":case"h":return i*r;case"minutes":case"minute":case"mins":case"min":case"m":return i*n;case"seconds":case"second":case"secs":case"sec":case"s":return i*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}(e);if("number"===u&&isFinite(e))return i.long?(a=e,(c=Math.abs(a))>=o?s(a,c,o,"day"):c>=r?s(a,c,r,"hour"):c>=n?s(a,c,n,"minute"):c>=t?s(a,c,t,"second"):a+" ms"):function(e){var s=Math.abs(e);return s>=o?Math.round(e/o)+"d":s>=r?Math.round(e/r)+"h":s>=n?Math.round(e/n)+"m":s>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},6974:(e,t,n)=>{"use strict";const r=n(2037),o=n(1875),s=process.env;let i;function a(e){const t=function(e){if(!1===i)return 0;if(o("color=16m")||o("color=full")||o("color=truecolor"))return 3;if(o("color=256"))return 2;if(e&&!e.isTTY&&!0!==i)return 0;const t=i?1:0;if("win32"===process.platform){const e=r.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in s)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some((e=>e in s))||"codeship"===s.CI_NAME?1:t;if("TEAMCITY_VERSION"in s)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(s.TEAMCITY_VERSION)?1:0;if("truecolor"===s.COLORTERM)return 3;if("TERM_PROGRAM"in s){const e=parseInt((s.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(s.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(s.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(s.TERM)||"COLORTERM"in s?1:(s.TERM,t)}(e);return function(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}(t)}o("no-color")||o("no-colors")||o("color=false")?i=!1:(o("color")||o("colors")||o("color=true")||o("color=always"))&&(i=!0),"FORCE_COLOR"in s&&(i=0===s.FORCE_COLOR.length||0!==parseInt(s.FORCE_COLOR,10)),e.exports={supportsColor:a,stdout:a(process.stdout),stderr:a(process.stderr)}},2927:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteTreeDataProvider=void 0;const r=n(9496),o=n(3750),s=n(9496),i=n(1122),a=n(7824),c=n(8680),u="remote-internal.getSshFoldersHistory",l="remote-internal.getGatewayFoldersHistory";t.RemoteTreeDataProvider=class{constructor(e){this.extensionContext=e,this.tunnels=[],this.sshHosts={},this.onDidChangeTreeDataEmitter=new s.EventEmitter,this.onDidChangeTreeData=this.onDidChangeTreeDataEmitter.event,this.extensionContext.subscriptions.push(this.onDidChangeTreeDataEmitter),this.extensionContext.subscriptions.push(r.commands.registerCommand("remote-explorer.refresh",this.refresh,this),r.commands.registerCommand("remote-explorer.add",this.add,this),r.commands.registerCommand("remote-explorer.configureSsh",this.configure,this),r.commands.registerCommand("remote-explorer.deleteFolderHistoryItem",this.deleteFolderFromHistory,this),r.commands.registerCommand("remote-explorer.connectToRemoteInCurrentWindow",this.openRemoteInCurrentWindow,this),r.commands.registerCommand("remote-explorer.connectToRemoteInNewWindow",this.openRemoteInNewWindow,this),r.commands.registerCommand("remote-explorer.connectToFolderInCurrentWindow",this.openFolderCurrentWindow,this),r.commands.registerCommand("remote-explorer.connectToFolderInNewWindow",this.openFolderInNewWindow,this)),this.initRefreshSshHostsPromise=this.refeshSshHosts(),this.initRefreshTunnelsPromise=this.refreshTunnels()}getTreeItem(e){return e.getTreeItem()}async getChildren(e){if(await this.initRefreshTunnelsPromise,await this.initRefreshSshHostsPromise,void 0===e)return[new a.RemoteGroupItem(a.RemoteGroupType.gateway),new a.RemoteGroupItem(a.RemoteGroupType.ssh)];if(e instanceof a.RemoteGroupItem&&e.type===a.RemoteGroupType.gateway){const e=[],t=[];for(const n of this.tunnels){const s=n,i=(0,o.getTunnelNameFromTags)(s);if(void 0===i)continue;const c=void 0!==s.status.hostConnectionCount&&0!==s.status.hostConnectionCount,u=s.tunnelId===this.activeTunnel?.tunnelId,h=(await r.commands.executeCommand(l,i)).length>0;c?e.push(new a.RemoteGatewayItem(s,i,u,c,h)):t.push(new a.RemoteGatewayItem(s,i,u,c,h))}return[...e.sort(a.RemoteGatewayItem.compare),...t.sort(a.RemoteGatewayItem.compare)]}if(e instanceof a.RemoteGroupItem&&e.type===a.RemoteGroupType.ssh){const e=[],t=Object.keys(this.sshHosts);for(const n of t){const t=n===this.activeSshHost?.hostName,o=(await r.commands.executeCommand(u,n)).length>0;e.push(new a.RemoteSshItem(n,n,t,o))}return e}if(e instanceof a.RemoteTargetItem&&e.hasFolders){const t=e instanceof a.RemoteGatewayItem,n=await r.commands.executeCommand(t?l:u,e.label),o=(0,i.getActiveFolders)(),s=[];for(const e of n)s.push(new a.FolderItem(e,t?a.RemoteProtocol.tunneling:a.RemoteProtocol.ssh,o.includes(e)));return(0,c.explorerFolderSortOrder)()===c.FolderSortOrder.alphabetical?s.sort(a.FolderItem.compare):s}return[]}async refresh(){await this.refreshTunnels(),await this.refeshSshHosts(),this.onDidChangeTreeDataEmitter.fire()}async openRemoteInCurrentWindow(e){e instanceof a.RemoteGatewayItem?this.openRemoteGateway(e,!1):e instanceof a.RemoteSshItem&&this.openSshHost(e,!1)}async openRemoteInNewWindow(e){e instanceof a.RemoteGatewayItem?this.openRemoteGateway(e,!0):e instanceof a.RemoteSshItem&&this.openSshHost(e,!0)}async add(e){if(e.type===a.RemoteGroupType.ssh)try{return await r.commands.executeCommand("opensshremotes.addNewSshHost")}catch(e){r.commands.executeCommand("workbench.extensions.action.showExtensionsWithIds",["ms-vscode-remote.remote-ssh"])}else try{return await r.commands.executeCommand("remote-server.help")}catch(e){r.commands.executeCommand("workbench.extensions.action.showExtensionsWithIds",["ms-vscode.remote-server"])}}async configure(){return await r.commands.executeCommand("opensshremotes.openConfigFile")}async openFolderCurrentWindow(e){await r.commands.executeCommand("vscode.openFolder",e.toUri())}async openFolderInNewWindow(e){await r.commands.executeCommand("vscode.openFolder",e.toUri(),!0)}async deleteFolderFromHistory(e){e.protocol===a.RemoteProtocol.ssh?await r.commands.executeCommand("remote-internal.deleteSshFolderFromHistory",e.fd):await r.commands.executeCommand("remote-internal.deleteGatewayFolderFromHistory",e.fd),this.onDidChangeTreeDataEmitter.fire()}async refreshTunnels(){try{this.tunnels=await r.commands.executeCommand("remote-internal.getTunnelsList"),this.activeTunnel=await r.commands.executeCommand("remote-internal.getActiveGatewayRemote")}catch(e){}}async refeshSshHosts(){try{this.activeSshHost=await r.commands.executeCommand("remote-internal.getActiveSshRemote"),this.sshHosts=await r.commands.executeCommand("remote-internal.getConfiguredHostnames")}catch(e){}}async openRemoteGateway(e,t){await r.commands.executeCommand("remote-internal.connectToRemoteGatewayTarget",e.label,t)}async openSshHost(e,t){const n={hostName:e.hostName};await r.commands.executeCommand("remote-internal.openRemoteSshTarget",n,t)}}},1122:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getActiveFolders=t.deactivate=t.activate=void 0;const r=n(9496),o=n(2927);var s=[];t.activate=async function(e){r.window.createTreeView("remoteTargets",{treeDataProvider:new o.RemoteTreeDataProvider(e),showCollapseAll:!0}),e.subscriptions.push(r.commands.registerCommand("remote-internal.setActiveFolders",(e=>{s=e})))},t.deactivate=function(){},t.getActiveFolders=function(){return s}},7824:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteProtocol=t.FolderItem=t.RemoteSshItem=t.RemoteGatewayItem=t.RemoteTargetItem=t.RemoteNotAvailableGroupItem=t.RemoteGroupItem=t.RemoteGroupType=void 0;const r=n(1017),o=n(9496),s=n(5523),i=(e,t)=>t;var a,c;!function(e){e[e.gateway=0]="gateway",e[e.ssh=1]="ssh"}(a=t.RemoteGroupType||(t.RemoteGroupType={}));class u{constructor(e){this.type=e}getTreeItem(){const e=new o.TreeItem(this.label,o.TreeItemCollapsibleState.Expanded);return this.type===a.ssh?e.contextValue="remote-explorer.sshGroup":e.contextValue="remote-explorer.gatewayGroup",e}get label(){return this.type===a.gateway?"Gateway":"SSH"}}t.RemoteGroupItem=u,t.RemoteNotAvailableGroupItem=class extends u{getTreeItem(){const e=new o.TreeItem(this.label);return e.description=i(0,"Unavailable in Desktop"),e}};class l{constructor(e,t,n){this.label=e,this.isActive=t,this.hasFolders=n,this.iconActive="vm-active",this.iconDefault="vm"}getTreeItem(){const e=new o.TreeItem(this.getLabel(),this.hasFolders?o.TreeItemCollapsibleState.Expanded:o.TreeItemCollapsibleState.None);return e.contextValue="remote-explorer.remoteTarget",e.iconPath=new o.ThemeIcon(this.isActive?this.iconActive:this.iconDefault,this.isActive?new o.ThemeColor("debugIcon.startForeground"):this.iconColor),e.tooltip=this.tooltip,e.description=this.isActive?i(0,"connected"):this.description,e}getLabel(){return this.label}get tooltip(){return this.label}get description(){return""}get iconColor(){}}t.RemoteTargetItem=l;class h extends l{constructor(e,t,n,r,o){super(t,n,o),this.tunnel=e,this.isOnline=r,this.iconDefault=r?"vm-running":"vm-outline"}get tooltip(){return this.isOnline?`${this.label} is ready to connect to.`:`${this.label} is offline.`}get description(){return this.isOnline?i(0,"running"):i(0,"offline")}}t.RemoteGatewayItem=h,h.compare=(e,t)=>e.label>t.label?1:e.label<t.label?-1:0,t.RemoteSshItem=class extends l{constructor(e,t,n,r){super(t,n,r),this.hostName=e}};class d{constructor(e,t,n){this.fd=e,this.protocol=t,this.isActive=n}getTreeItem(){let e=this.fd.name??r.posix.basename(this.fd.folder);e.endsWith(".code-workspace")&&(e=`${e.replace(/\.code-workspace$/,"")} (Workspace)`);const t=new o.TreeItem(e),n=(0,s.clientPlatformAgnosticFsPath)(this.fd.folder);return t.description=n.match(/^[a-z]:/i)?r.win32.dirname(n):r.posix.dirname(n),t.tooltip=`'${n}' on ${this.fd.remote}`,t.contextValue="remote-explorer.remoteFolder",t.resourceUri=this.toUri(),t.iconPath=new o.ThemeIcon(this.isActive?"folder-active":"folder"),t}toUri(){return o.Uri.parse(`vscode-remote://${this.protocol}+${this.fd.remote}${this.fd.folder}`)}}t.FolderItem=d,d.compare=(e,t)=>e.fd.folder>t.fd.folder?1:e.fd.folder<t.fd.folder?-1:0,(c=t.RemoteProtocol||(t.RemoteProtocol={})).ssh="ssh-remote",c.tunneling="tunneling"},8680:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.explorerFolderSortOrder=t.FolderSortOrder=void 0;const r=n(9496);var o;!function(e){e[e.mru=1]="mru",e[e.alphabetical=2]="alphabetical"}(o=t.FolderSortOrder||(t.FolderSortOrder={})),t.explorerFolderSortOrder=function(){let e=r.workspace.getConfiguration().get("remote-explorer.foldersSortOrder")||r.workspace.getConfiguration().get("remote.SSH.foldersSortOrder")||"most recently used";return"most recently used"===e&&(e="mru"),o[e]}},1401:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWindows=void 0,t.isWindows="win32"===process.platform},5523:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clientPlatformAgnosticFsPath=void 0;const r=n(9496),o=n(1401);t.clientPlatformAgnosticFsPath=function(e){const t=r.Uri.file(e);return o.isWindows&&!e.match(/^[a-z]:/i)?t.fsPath.replace(/\\/g,"/"):t.fsPath}},3750:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AccessTokenBasisClient:()=>u,BasisClient:()=>c,BasisWebSocketFactory:()=>h,ConnectionManager:()=>le,ServerConnectionBearer:()=>he,TunnelNotFoundError:()=>l,TunnelNotFoundInSessionsError:()=>we,WebExtHostRPC:()=>fe,getMatchingSessionForTunnel:()=>ye,getMatchingSessionForTunnelName:()=>ge,getTunnelNameFromTags:()=>me});class r extends Error{}const o=(e,t,n)=>new Promise(((o,s)=>{const i=setTimeout((()=>s(new r(n??"Operation timed out"))),t);e.then(o,s).finally((()=>clearTimeout(i)))}));var s=n(7775),i=n(1928);class a{constructor(e){this.executor=e,this._didRun=!1}hasValue(){return this._didRun}getValue(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}map(e){return new a((()=>e(this.getValue())))}}class c{constructor(){this.managementClient=new a((()=>this.createTunnelManagementClient())),this.tunnelLookupCache=new Map,this.taggedTunnelLookupCache=new Map}getManagementClient(){return this.managementClient.getValue()}async connect(e){if(!e.endpoints){const t=await this.getTunnel(e);if(!t)throw new l;e=t}const{TunnelRelayTunnelClient:t}=await n.e(605).then(n.t.bind(n,9605,23)),r=new t;return r.acceptLocalConnectionsForForwardedPorts=!1,await r.connectClient(e,e.endpoints),r}async getTunnelForTag(e){if(this.taggedTunnelLookupCache.has(e))return this.taggedTunnelLookupCache.get(e);const t=await this.getManagementClient(),[n]=await t.listTunnels(void 0,void 0,{tags:[e,"vscode-server-launcher"],requireAllTags:!0});if(!n)return;const r=await this.getTunnel(n);return r&&this.taggedTunnelLookupCache.set(e,r),r}async getTunnel(e,t=!0){const n=e.name||e.tunnelId;if(t&&this.tunnelLookupCache.has(n))return this.tunnelLookupCache.get(n);try{const t=await this.getManagementClient(),r=await t.getTunnel(e,{includePorts:!0,scopes:["connect"],tokenScopes:["connect"]});return r&&this.tunnelLookupCache.set(n,r),r||void 0}catch(e){if(e instanceof Error&&e.message.includes("Not Found"))return;throw e}}}c.BASIS_SCOPES=[`${s.TunnelServiceProperties.production.serviceAppId}/.default`];class u extends c{constructor(e,t,n){super(),this.provider=e,this.userAgent=t,this.getAccessToken=n}async createTunnelManagementClient(){const e="microsoft"===this.provider?`Bearer ${await this.getAccessToken()}`:`github client_id=01ab8ac9400c4e429b23 ${await this.getAccessToken()}`;return new i.TunnelManagementHttpClient(this.userAgent,(async()=>e))}}class l extends Error{constructor(){super("Tunnel not found")}}class h{constructor(e){this.manager=e}create(e){return this.manager.getWebSocket(e)}}class d{constructor(){this.event=(e,t,n)=>{const r=this.add(t?e.bind(t):e);return n?.push(r),r}}get size(){return this.listeners?"function"==typeof this.listeners?1:this.listeners.length:0}fire(e){if(this.listeners)if("function"==typeof this.listeners)this.listeners(e);else for(const t of this.listeners)t(e)}dispose(){this.listeners=void 0}add(e){return this.listeners?"function"==typeof this.listeners?this.listeners=[this.listeners,e]:this.listeners.push(e):this.listeners=e,{dispose:()=>this.rm(e)}}rm(e){if(!this.listeners)return;if("function"==typeof this.listeners)return void(this.listeners===e&&(this.listeners=void 0));const t=this.listeners.indexOf(e);-1!==t&&(2===this.listeners.length?this.listeners=0===t?this.listeners[1]:this.listeners[0]:this.listeners=this.listeners.slice(0,t).concat(this.listeners.slice(t+1)))}}class p extends Error{constructor(e){super(e.message),this.code="ECONNREFUSED",this.syscall="connect",this.stack=e.stack}}class f{constructor(e){this.options=e,this.SOCKET_TYPE="Local Proxy Server Socket",this.dispose=[],this.onDataEmitter=new d,this.onData=this.onDataEmitter.event,this.onOpenEmitter=new d,this.onOpen=this.onOpenEmitter.event,this.onCloseEmitter=new d,this.onClose=this.onCloseEmitter.event,this.onErrorEmitter=new d,this.onError=this.onErrorEmitter.event}send(e){this.options.bearer.notify("servermsg",{i:this.options.socketId,body:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)})}close(){this.dispose.forEach((e=>e.dispose()))}onMessage(e){this.onDataEmitter.fire(e)}upgradeToWebSocketConnection(){}async initialize(){try{const{tunnel:e}=await this.options.bearer.acquire();await async function(e,t,n,r){let o=function(e,t,n){return{socket_id:t,commit_id:e.commit,quality:e.quality,telemetry_level:"off",extensions:n??[]}}(t,n,r),s=await e.call("serve",o);return{tunnel:s.tunnel,port:s.listening_port}}(this.options.bearer,this.options.product,this.options.socketId,this.options.extensions),this.dispose.push(this.options.bearer.onNotification("servermsg",(({i:e,body:t})=>{e===this.options.socketId&&this.onMessage(t)}))),this.upgradeToWebSocketConnection(),e.on("error",(e=>{this.onErrorEmitter.fire(new p(e)),this.onCloseEmitter.fire()})).on("close",(()=>{this.onCloseEmitter.fire()}))}catch(e){return e instanceof r&&(e=new p(e)),void this.onErrorEmitter.fire(e)}}}class m extends f{constructor(e){super(e),this._options=e,this.onDataEmitter=new d,this.onData=this.onDataEmitter.event,this.onOpenEmitter=new d,this.onOpen=this.onOpenEmitter.event,this.onCloseEmitter=new d,this.onClose=this.onCloseEmitter.event,this.onErrorEmitter=new d,this.onError=this.onErrorEmitter.event,this.waitingForOpen=!0,this.SOCKET_TYPE="Basis Socket"}onMessage(e){this.waitingForOpen?(this.onOpenEmitter.fire(),this.waitingForOpen=!1):this.onDataEmitter.fire(e)}async upgradeToWebSocketConnection(){const e=this._options.url.replace(/skipWebSocketFrames=false/gim,"skipWebSocketFrames=true");await this._options.bearer.notify("servermsg",{i:this._options.socketId,body:(new TextEncoder).encode(this.createHandshakeRequest(e))})}createHandshakeRequest(e){return[`GET ${e} HTTP/1.1`,"Connection: Upgrade","Upgrade: websocket",`Sec-WebSocket-Key: ${this.randomString(32)}`,"\r\n"].join("\r\n")}randomString(e=16){const t=new Uint32Array(e);return crypto.getRandomValues(t),t.toString()}}var g,y,v,w=4294967295;function b(e,t,n){var r=Math.floor(n/4294967296),o=n;e.setUint32(t,r),e.setUint32(t+4,o)}function T(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}var C=("undefined"==typeof process||"never"!==(null===(g=null===process||void 0===process?void 0:process.env)||void 0===g?void 0:g.TEXT_ENCODING))&&"undefined"!=typeof TextEncoder&&"undefined"!=typeof TextDecoder;function x(e){for(var t=e.length,n=0,r=0;r<t;){var o=e.charCodeAt(r++);if(0!=(4294967168&o))if(0==(4294965248&o))n+=2;else{if(o>=55296&&o<=56319&&r<t){var s=e.charCodeAt(r);56320==(64512&s)&&(++r,o=((1023&o)<<10)+(1023&s)+65536)}n+=0==(4294901760&o)?3:4}else n++}return n}var E=C?new TextEncoder:void 0,S=C?"undefined"!=typeof process&&"force"!==(null===(y=null===process||void 0===process?void 0:process.env)||void 0===y?void 0:y.TEXT_ENCODING)?200:0:w,A=(null==E?void 0:E.encodeInto)?function(e,t,n){E.encodeInto(e,t.subarray(n))}:function(e,t,n){t.set(E.encode(e),n)};function I(e,t,n){for(var r=t,o=r+n,s=[],i="";r<o;){var a=e[r++];if(0==(128&a))s.push(a);else if(192==(224&a)){var c=63&e[r++];s.push((31&a)<<6|c)}else if(224==(240&a)){c=63&e[r++];var u=63&e[r++];s.push((31&a)<<12|c<<6|u)}else if(240==(248&a)){var l=(7&a)<<18|(c=63&e[r++])<<12|(u=63&e[r++])<<6|63&e[r++];l>65535&&(l-=65536,s.push(l>>>10&1023|55296),l=56320|1023&l),s.push(l)}else s.push(a);s.length>=4096&&(i+=String.fromCharCode.apply(String,s),s.length=0)}return s.length>0&&(i+=String.fromCharCode.apply(String,s)),i}var R,U=C?new TextDecoder:null,_=C?"undefined"!=typeof process&&"force"!==(null===(v=null===process||void 0===process?void 0:process.env)||void 0===v?void 0:v.TEXT_DECODER)?200:0:w,k=function(e,t){this.type=e,this.data=t},P=(R=function(e,t){return R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},R(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}R(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),O=function(e){function t(n){var r=e.call(this,n)||this,o=Object.create(t.prototype);return Object.setPrototypeOf(r,o),Object.defineProperty(r,"name",{configurable:!0,enumerable:!1,value:t.name}),r}return P(t,e),t}(Error),F={type:-1,encode:function(e){var t,n,r,o;return e instanceof Date?function(e){var t,n=e.sec,r=e.nsec;if(n>=0&&r>=0&&n<=17179869183){if(0===r&&n<=4294967295){var o=new Uint8Array(4);return(t=new DataView(o.buffer)).setUint32(0,n),o}var s=n/4294967296,i=4294967295&n;return o=new Uint8Array(8),(t=new DataView(o.buffer)).setUint32(0,r<<2|3&s),t.setUint32(4,i),o}return o=new Uint8Array(12),(t=new DataView(o.buffer)).setUint32(0,r),b(t,4,n),o}((r=1e6*((t=e.getTime())-1e3*(n=Math.floor(t/1e3))),{sec:n+(o=Math.floor(r/1e9)),nsec:r-1e9*o})):null},decode:function(e){var t=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:var n=t.getUint32(0);return{sec:4294967296*(3&n)+t.getUint32(4),nsec:n>>>2};case 12:return{sec:T(t,4),nsec:t.getUint32(0)};default:throw new O("Unrecognized data size for timestamp (expected 4, 8, or 12): ".concat(e.length))}}(e);return new Date(1e3*t.sec+t.nsec/1e6)}},j=function(){function e(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(F)}return e.prototype.register=function(e){var t=e.type,n=e.encode,r=e.decode;if(t>=0)this.encoders[t]=n,this.decoders[t]=r;else{var o=1+t;this.builtInEncoders[o]=n,this.builtInDecoders[o]=r}},e.prototype.tryToEncode=function(e,t){for(var n=0;n<this.builtInEncoders.length;n++)if(null!=(r=this.builtInEncoders[n])&&null!=(o=r(e,t)))return new k(-1-n,o);for(n=0;n<this.encoders.length;n++){var r,o;if(null!=(r=this.encoders[n])&&null!=(o=r(e,t)))return new k(n,o)}return e instanceof k?e:null},e.prototype.decode=function(e,t,n){var r=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return r?r(e,t,n):new k(t,e)},e.defaultCodec=new e,e}();function B(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Uint8Array.from(e)}var N=function(){function e(e,t,n,r,o,s,i,a){void 0===e&&(e=j.defaultCodec),void 0===t&&(t=void 0),void 0===n&&(n=100),void 0===r&&(r=2048),void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===i&&(i=!1),void 0===a&&(a=!1),this.extensionCodec=e,this.context=t,this.maxDepth=n,this.initialBufferSize=r,this.sortKeys=o,this.forceFloat32=s,this.ignoreUndefined=i,this.forceIntegerToFloat=a,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return e.prototype.getUint8Array=function(){return this.bytes.subarray(0,this.pos)},e.prototype.reinitializeState=function(){this.pos=0},e.prototype.encode=function(e){return this.reinitializeState(),this.doEncode(e,1),this.getUint8Array()},e.prototype.doEncode=function(e,t){if(t>this.maxDepth)throw new Error("Too deep objects in depth ".concat(t));null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.encodeObject(e,t)},e.prototype.ensureBufferSizeToWrite=function(e){var t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)},e.prototype.resizeBuffer=function(e){var t=new ArrayBuffer(e),n=new Uint8Array(t),r=new DataView(t);n.set(this.bytes),this.view=r,this.bytes=n},e.prototype.encodeNil=function(){this.writeU8(192)},e.prototype.encodeBoolean=function(e){!1===e?this.writeU8(194):this.writeU8(195)},e.prototype.encodeNumber=function(e){Number.isSafeInteger(e)&&!this.forceIntegerToFloat?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):(this.writeU8(211),this.writeI64(e)):this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))},e.prototype.writeStringHeader=function(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else{if(!(e<4294967296))throw new Error("Too long string: ".concat(e," bytes in UTF-8"));this.writeU8(219),this.writeU32(e)}},e.prototype.encodeString=function(e){if(e.length>S){var t=x(e);this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),A(e,this.bytes,this.pos),this.pos+=t}else t=x(e),this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),function(e,t,n){for(var r=e.length,o=n,s=0;s<r;){var i=e.charCodeAt(s++);if(0!=(4294967168&i)){if(0==(4294965248&i))t[o++]=i>>6&31|192;else{if(i>=55296&&i<=56319&&s<r){var a=e.charCodeAt(s);56320==(64512&a)&&(++s,i=((1023&i)<<10)+(1023&a)+65536)}0==(4294901760&i)?(t[o++]=i>>12&15|224,t[o++]=i>>6&63|128):(t[o++]=i>>18&7|240,t[o++]=i>>12&63|128,t[o++]=i>>6&63|128)}t[o++]=63&i|128}else t[o++]=i}}(e,this.bytes,this.pos),this.pos+=t},e.prototype.encodeObject=function(e,t){var n=this.extensionCodec.tryToEncode(e,this.context);if(null!=n)this.encodeExtension(n);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!=typeof e)throw new Error("Unrecognized object: ".concat(Object.prototype.toString.apply(e)));this.encodeMap(e,t)}},e.prototype.encodeBinary=function(e){var t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large binary: ".concat(t));this.writeU8(198),this.writeU32(t)}var n=B(e);this.writeU8a(n)},e.prototype.encodeArray=function(e,t){var n=e.length;if(n<16)this.writeU8(144+n);else if(n<65536)this.writeU8(220),this.writeU16(n);else{if(!(n<4294967296))throw new Error("Too large array: ".concat(n));this.writeU8(221),this.writeU32(n)}for(var r=0,o=e;r<o.length;r++){var s=o[r];this.doEncode(s,t+1)}},e.prototype.countWithoutUndefined=function(e,t){for(var n=0,r=0,o=t;r<o.length;r++)void 0!==e[o[r]]&&n++;return n},e.prototype.encodeMap=function(e,t){var n=Object.keys(e);this.sortKeys&&n.sort();var r=this.ignoreUndefined?this.countWithoutUndefined(e,n):n.length;if(r<16)this.writeU8(128+r);else if(r<65536)this.writeU8(222),this.writeU16(r);else{if(!(r<4294967296))throw new Error("Too large map object: ".concat(r));this.writeU8(223),this.writeU32(r)}for(var o=0,s=n;o<s.length;o++){var i=s[o],a=e[i];this.ignoreUndefined&&void 0===a||(this.encodeString(i),this.doEncode(a,t+1))}},e.prototype.encodeExtension=function(e){var t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large extension object: ".concat(t));this.writeU8(201),this.writeU32(t)}this.writeI8(e.type),this.writeU8a(e.data)},e.prototype.writeU8=function(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++},e.prototype.writeU8a=function(e){var t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t},e.prototype.writeI8=function(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++},e.prototype.writeU16=function(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2},e.prototype.writeI16=function(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2},e.prototype.writeU32=function(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4},e.prototype.writeI32=function(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4},e.prototype.writeF32=function(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4},e.prototype.writeF64=function(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8},e.prototype.writeU64=function(e){this.ensureBufferSizeToWrite(8),function(e,t,n){var r=n/4294967296,o=n;e.setUint32(t,r),e.setUint32(t+4,o)}(this.view,this.pos,e),this.pos+=8},e.prototype.writeI64=function(e){this.ensureBufferSizeToWrite(8),b(this.view,this.pos,e),this.pos+=8},e}(),q={};function M(e,t){return void 0===t&&(t=q),new N(t.extensionCodec,t.context,t.maxDepth,t.initialBufferSize,t.sortKeys,t.forceFloat32,t.ignoreUndefined,t.forceIntegerToFloat).encode(e)}function L(e){return"".concat(e<0?"-":"","0x").concat(Math.abs(e).toString(16).padStart(2,"0"))}var D=function(){function e(e,t){void 0===e&&(e=16),void 0===t&&(t=16),this.maxKeyLength=e,this.maxLengthPerKey=t,this.hit=0,this.miss=0,this.caches=[];for(var n=0;n<this.maxKeyLength;n++)this.caches.push([])}return e.prototype.canBeCached=function(e){return e>0&&e<=this.maxKeyLength},e.prototype.find=function(e,t,n){e:for(var r=0,o=this.caches[n-1];r<o.length;r++){for(var s=o[r],i=s.bytes,a=0;a<n;a++)if(i[a]!==e[t+a])continue e;return s.str}return null},e.prototype.store=function(e,t){var n=this.caches[e.length-1],r={bytes:e,str:t};n.length>=this.maxLengthPerKey?n[Math.random()*n.length|0]=r:n.push(r)},e.prototype.decode=function(e,t,n){var r=this.find(e,t,n);if(null!=r)return this.hit++,r;this.miss++;var o=I(e,t,n),s=Uint8Array.prototype.slice.call(e,t,t+n);return this.store(s,o),o},e}(),H=function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},$=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,o,(t=e[n](t)).done,t.value)}))}}},z=function(e){return this instanceof z?(this.v=e,this):new z(e)},G=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),s=[];return r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r;function i(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){s.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{(n=o[e](t)).value instanceof z?Promise.resolve(n.value.v).then(c,u):l(s[0][2],n)}catch(e){l(s[0][3],e)}var n}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}},W=new DataView(new ArrayBuffer(0)),V=new Uint8Array(W.buffer),J=function(){try{W.getInt8(0)}catch(e){return e.constructor}throw new Error("never reached")}(),K=new J("Insufficient data"),X=new D,Y=function(){function e(e,t,n,r,o,s,i,a){void 0===e&&(e=j.defaultCodec),void 0===t&&(t=void 0),void 0===n&&(n=w),void 0===r&&(r=w),void 0===o&&(o=w),void 0===s&&(s=w),void 0===i&&(i=w),void 0===a&&(a=X),this.extensionCodec=e,this.context=t,this.maxStrLength=n,this.maxBinLength=r,this.maxArrayLength=o,this.maxMapLength=s,this.maxExtLength=i,this.keyDecoder=a,this.totalPos=0,this.pos=0,this.view=W,this.bytes=V,this.headByte=-1,this.stack=[]}return e.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=-1,this.stack.length=0},e.prototype.setBuffer=function(e){this.bytes=B(e),this.view=function(e){if(e instanceof ArrayBuffer)return new DataView(e);var t=B(e);return new DataView(t.buffer,t.byteOffset,t.byteLength)}(this.bytes),this.pos=0},e.prototype.appendBuffer=function(e){if(-1!==this.headByte||this.hasRemaining(1)){var t=this.bytes.subarray(this.pos),n=B(e),r=new Uint8Array(t.length+n.length);r.set(t),r.set(n,t.length),this.setBuffer(r)}else this.setBuffer(e)},e.prototype.hasRemaining=function(e){return this.view.byteLength-this.pos>=e},e.prototype.createExtraByteError=function(e){var t=this.view,n=this.pos;return new RangeError("Extra ".concat(t.byteLength-n," of ").concat(t.byteLength," byte(s) found at buffer[").concat(e,"]"))},e.prototype.decode=function(e){this.reinitializeState(),this.setBuffer(e);var t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t},e.prototype.decodeMulti=function(e){return H(this,(function(t){switch(t.label){case 0:this.reinitializeState(),this.setBuffer(e),t.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return t.sent(),[3,1];case 3:return[2]}}))},e.prototype.decodeAsync=function(e){var t,n,r,o,s,i,a,c;return s=this,i=void 0,c=function(){var s,i,a,c,u,l,h,d;return H(this,(function(p){switch(p.label){case 0:s=!1,p.label=1;case 1:p.trys.push([1,6,7,12]),t=$(e),p.label=2;case 2:return[4,t.next()];case 3:if((n=p.sent()).done)return[3,5];if(a=n.value,s)throw this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{i=this.doDecodeSync(),s=!0}catch(e){if(!(e instanceof J))throw e}this.totalPos+=this.pos,p.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return c=p.sent(),r={error:c},[3,12];case 7:return p.trys.push([7,,10,11]),n&&!n.done&&(o=t.return)?[4,o.call(t)]:[3,9];case 8:p.sent(),p.label=9;case 9:return[3,11];case 10:if(r)throw r.error;return[7];case 11:return[7];case 12:if(s){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,i]}throw l=(u=this).headByte,h=u.pos,d=u.totalPos,new RangeError("Insufficient data in parsing ".concat(L(l)," at ").concat(d," (").concat(h," in the current buffer)"))}}))},new((a=void 0)||(a=Promise))((function(e,t){function n(e){try{o(c.next(e))}catch(e){t(e)}}function r(e){try{o(c.throw(e))}catch(e){t(e)}}function o(t){var o;t.done?e(t.value):(o=t.value,o instanceof a?o:new a((function(e){e(o)}))).then(n,r)}o((c=c.apply(s,i||[])).next())}))},e.prototype.decodeArrayStream=function(e){return this.decodeMultiAsync(e,!0)},e.prototype.decodeStream=function(e){return this.decodeMultiAsync(e,!1)},e.prototype.decodeMultiAsync=function(e,t){return G(this,arguments,(function(){var n,r,o,s,i,a,c,u,l;return H(this,(function(h){switch(h.label){case 0:n=t,r=-1,h.label=1;case 1:h.trys.push([1,13,14,19]),o=$(e),h.label=2;case 2:return[4,z(o.next())];case 3:if((s=h.sent()).done)return[3,12];if(i=s.value,t&&0===r)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),n&&(r=this.readArraySize(),n=!1,this.complete()),h.label=4;case 4:h.trys.push([4,9,,10]),h.label=5;case 5:return[4,z(this.doDecodeSync())];case 6:return[4,h.sent()];case 7:return h.sent(),0==--r?[3,8]:[3,5];case 8:return[3,10];case 9:if(!((a=h.sent())instanceof J))throw a;return[3,10];case 10:this.totalPos+=this.pos,h.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return c=h.sent(),u={error:c},[3,19];case 14:return h.trys.push([14,,17,18]),s&&!s.done&&(l=o.return)?[4,z(l.call(o))]:[3,16];case 15:h.sent(),h.label=16;case 16:return[3,18];case 17:if(u)throw u.error;return[7];case 18:return[7];case 19:return[2]}}))}))},e.prototype.doDecodeSync=function(){e:for(;;){var e=this.readHeadByte(),t=void 0;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){if(0!=(r=e-128)){this.pushMapState(r),this.complete();continue e}t={}}else if(e<160){if(0!=(r=e-144)){this.pushArrayState(r),this.complete();continue e}t=[]}else{var n=e-160;t=this.decodeUtf8String(n,0)}else if(192===e)t=null;else if(194===e)t=!1;else if(195===e)t=!0;else if(202===e)t=this.readF32();else if(203===e)t=this.readF64();else if(204===e)t=this.readU8();else if(205===e)t=this.readU16();else if(206===e)t=this.readU32();else if(207===e)t=this.readU64();else if(208===e)t=this.readI8();else if(209===e)t=this.readI16();else if(210===e)t=this.readI32();else if(211===e)t=this.readI64();else if(217===e)n=this.lookU8(),t=this.decodeUtf8String(n,1);else if(218===e)n=this.lookU16(),t=this.decodeUtf8String(n,2);else if(219===e)n=this.lookU32(),t=this.decodeUtf8String(n,4);else if(220===e){if(0!==(r=this.readU16())){this.pushArrayState(r),this.complete();continue e}t=[]}else if(221===e){if(0!==(r=this.readU32())){this.pushArrayState(r),this.complete();continue e}t=[]}else if(222===e){if(0!==(r=this.readU16())){this.pushMapState(r),this.complete();continue e}t={}}else if(223===e){if(0!==(r=this.readU32())){this.pushMapState(r),this.complete();continue e}t={}}else if(196===e){var r=this.lookU8();t=this.decodeBinary(r,1)}else if(197===e)r=this.lookU16(),t=this.decodeBinary(r,2);else if(198===e)r=this.lookU32(),t=this.decodeBinary(r,4);else if(212===e)t=this.decodeExtension(1,0);else if(213===e)t=this.decodeExtension(2,0);else if(214===e)t=this.decodeExtension(4,0);else if(215===e)t=this.decodeExtension(8,0);else if(216===e)t=this.decodeExtension(16,0);else if(199===e)r=this.lookU8(),t=this.decodeExtension(r,1);else if(200===e)r=this.lookU16(),t=this.decodeExtension(r,2);else{if(201!==e)throw new O("Unrecognized type byte: ".concat(L(e)));r=this.lookU32(),t=this.decodeExtension(r,4)}this.complete();for(var o=this.stack;o.length>0;){var s=o[o.length-1];if(0===s.type){if(s.array[s.position]=t,s.position++,s.position!==s.size)continue e;o.pop(),t=s.array}else{if(1===s.type){if(void 0,"string"!=(i=typeof t)&&"number"!==i)throw new O("The type of key must be string or number but "+typeof t);if("__proto__"===t)throw new O("The key __proto__ is not allowed");s.key=t,s.type=2;continue e}if(s.map[s.key]=t,s.readCount++,s.readCount!==s.size){s.key=null,s.type=1;continue e}o.pop(),t=s.map}}return t}var i},e.prototype.readHeadByte=function(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte},e.prototype.complete=function(){this.headByte=-1},e.prototype.readArraySize=function(){var e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new O("Unrecognized array type byte: ".concat(L(e)))}},e.prototype.pushMapState=function(e){if(e>this.maxMapLength)throw new O("Max length exceeded: map length (".concat(e,") > maxMapLengthLength (").concat(this.maxMapLength,")"));this.stack.push({type:1,size:e,key:null,readCount:0,map:{}})},e.prototype.pushArrayState=function(e){if(e>this.maxArrayLength)throw new O("Max length exceeded: array length (".concat(e,") > maxArrayLength (").concat(this.maxArrayLength,")"));this.stack.push({type:0,size:e,array:new Array(e),position:0})},e.prototype.decodeUtf8String=function(e,t){var n;if(e>this.maxStrLength)throw new O("Max length exceeded: UTF-8 byte length (".concat(e,") > maxStrLength (").concat(this.maxStrLength,")"));if(this.bytes.byteLength<this.pos+t+e)throw K;var r,o=this.pos+t;return r=this.stateIsMapKey()&&(null===(n=this.keyDecoder)||void 0===n?void 0:n.canBeCached(e))?this.keyDecoder.decode(this.bytes,o,e):e>_?function(e,t,n){var r=e.subarray(t,t+n);return U.decode(r)}(this.bytes,o,e):I(this.bytes,o,e),this.pos+=t+e,r},e.prototype.stateIsMapKey=function(){return this.stack.length>0&&1===this.stack[this.stack.length-1].type},e.prototype.decodeBinary=function(e,t){if(e>this.maxBinLength)throw new O("Max length exceeded: bin length (".concat(e,") > maxBinLength (").concat(this.maxBinLength,")"));if(!this.hasRemaining(e+t))throw K;var n=this.pos+t,r=this.bytes.subarray(n,n+e);return this.pos+=t+e,r},e.prototype.decodeExtension=function(e,t){if(e>this.maxExtLength)throw new O("Max length exceeded: ext length (".concat(e,") > maxExtLength (").concat(this.maxExtLength,")"));var n=this.view.getInt8(this.pos+t),r=this.decodeBinary(e,t+1);return this.extensionCodec.decode(r,n,this.context)},e.prototype.lookU8=function(){return this.view.getUint8(this.pos)},e.prototype.lookU16=function(){return this.view.getUint16(this.pos)},e.prototype.lookU32=function(){return this.view.getUint32(this.pos)},e.prototype.readU8=function(){var e=this.view.getUint8(this.pos);return this.pos++,e},e.prototype.readI8=function(){var e=this.view.getInt8(this.pos);return this.pos++,e},e.prototype.readU16=function(){var e=this.view.getUint16(this.pos);return this.pos+=2,e},e.prototype.readI16=function(){var e=this.view.getInt16(this.pos);return this.pos+=2,e},e.prototype.readU32=function(){var e=this.view.getUint32(this.pos);return this.pos+=4,e},e.prototype.readI32=function(){var e=this.view.getInt32(this.pos);return this.pos+=4,e},e.prototype.readU64=function(){var e,t,n=(e=this.view,t=this.pos,4294967296*e.getUint32(t)+e.getUint32(t+4));return this.pos+=8,n},e.prototype.readI64=function(){var e=T(this.view,this.pos);return this.pos+=8,e},e.prototype.readF32=function(){var e=this.view.getFloat32(this.pos);return this.pos+=4,e},e.prototype.readF64=function(){var e=this.view.getFloat64(this.pos);return this.pos+=8,e},e}(),Z=function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},Q=function(e){return this instanceof Q?(this.v=e,this):new Q(e)},ee=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),s=[];return r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r;function i(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){s.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{(n=o[e](t)).value instanceof Q?Promise.resolve(n.value.v).then(c,u):l(s[0][2],n)}catch(e){l(s[0][3],e)}var n}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}};function te(e){if(null==e)throw new Error("Assertion Failure: value must not be null nor undefined")}var ne={};function re(e,t){void 0===t&&(t=ne);var n=function(e){return null!=e[Symbol.asyncIterator]?e:function(e){return ee(this,arguments,(function(){var t,n,r,o;return Z(this,(function(s){switch(s.label){case 0:t=e.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,Q(t.read())];case 3:return n=s.sent(),r=n.done,o=n.value,r?[4,Q(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return te(o),[4,Q(o)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}(e)}(e);return new Y(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeStream(n)}let oe=0;class se extends Error{constructor(e,t){super(`json rpc error ${e}: message`),this.code=e,this.message=t}}class ie{constructor(e){this.callbacks=new Map,this.callHandlers=new Map,this.startEmitter=new d,this.onStartConnecting=this.startEmitter.event,this.notifyEmitter=new d,this.closeEmitter=new d,this.onClose=this.closeEmitter.event,this.BEARER_TYPE=e}async acquire(){this.streamPromise??(this.streamPromise=this.acquireNow());try{return await this.streamPromise}catch(e){throw this.streamPromise=void 0,e}}async close(){this.streamPromise?.then((e=>e.tunnel.end())),this.streamPromise=void 0}async call(e,t){const{tunnel:n}=await this.acquire(),r=oe++;return new Promise(((o,s)=>{this.callbacks.set(r,{resolve:e=>{"error"in e?s(new se(e.error?.code,e.error?.message)):o(e.result)},reject:s}),this.encodeToTunnel(n,{id:r,method:e,params:t})})).finally((()=>this.callbacks.delete(r)))}async registerRequestHandler(e,t){this.callHandlers.has(e)&&console.warn("Overriding previous handler for method: ",e),this.callHandlers.set(e,t)}async handleRequest(e){const{tunnel:t}=await this.acquire();if(!this.callHandlers.has(e.method)){const n={id:e.id,error:{message:"Unknown method. Cannot resolve request",code:36}};return void this.encodeToTunnel(t,n)}const n=this.callHandlers.get(e.method),r=await n(e.params),o={id:e.id,result:r};this.encodeToTunnel(t,o)}onNotification(e,t){return this.notifyEmitter.event((n=>{n.method===e&&t(n.params)}))}async notify(e,t){const{tunnel:n}=await this.acquire();this.encodeToTunnel(n,{method:e,params:t})}async getConnectionTunnel(){throw new Error("Not implemented")}async acquireNow(){const e=await this.getConnectionTunnel();return this.startEmitter.fire(),(async()=>{for await(const t of re(e)){const e=t;"result"in e||"error"in e?this.callbacks.get(e.id)?.resolve(e):"id"in e&&"number"==typeof e.id?this.handleRequest(e):this.notifyEmitter.fire(e)}})(),e.on("close",(()=>{this.rejectAllCalls(new se(0,`${this.BEARER_TYPE}: Connection closed`)),this.closeEmitter.fire(void 0),this.streamPromise=void 0})),e.on("error",(e=>{const t=new se(0,e.message);this.rejectAllCalls(t),this.closeEmitter.fire(t),this.streamPromise=void 0})),{tunnel:e}}rejectAllCalls(e){for(const{reject:t}of this.callbacks.values())t(e);this.callbacks.clear()}encodeToTunnel(e,t){throw new Error("Not implemented")}}class ae{constructor(){this.rejected=!1,this.resolved=!1,this.p=new Promise(((e,t)=>{this.completeCallback=e,this.errorCallback=t}))}get isRejected(){return this.rejected}get isResolved(){return this.resolved}get isSettled(){return this.rejected||this.resolved}complete(e){this.completeCallback(e),this.resolved=!0}error(e){this.errorCallback(e),this.rejected=!0}}const ce=3e4;class ue extends ie{constructor(e,t,n){super("Port Forwarding Service"),this.basis=e,this.tunnel=t,this.port=n,this.versionPromise=new ae,this.tunnelMayBeStale=!1,this.version=this.versionPromise.p,this.onNotification("version",(({version:e})=>{this.versionPromise.complete(e)}))}async call(e,t){return await super.call(e,t)}onNotification(e,t){return super.onNotification(e,t)}async notify(e,t){return await super.notify(e,t)}async getConnectionTunnel(){if(this.tunnelMayBeStale){const e=await this.basis.getTunnel(this.tunnel,!1);e&&(this.tunnel=e)}if(!this.tunnel.endpoints?.length)throw new p(new Error("The VS Code gateway is not currently running."));const e=await o(this.basis.connect(this.tunnel),ce,"Timeout connecting to relay");try{await o(e.waitForForwardedPort(this.port),ce,"Timeout waiting for forwarded port");const t=await o(e.connectToForwardedPort(this.port),ce,"Timeout connecting to port");return t.on("close",(()=>{this.tunnelMayBeStale=!0})),t.on("error",(()=>{this.tunnelMayBeStale=!0})),t}catch(t){throw e.dispose(),t}}encodeToTunnel(e,t){const n=M(t),r=new Uint8Array(4+n.length);new DataView(r.buffer).setUint32(0,n.length),r.set(n,4),e.write(r)}}class le{constructor(e){this.options=e,this.socketId=0,this.connectedEmitter=new d,this.onConnected=this.connectedEmitter.event,this.logEmitter=new d,this.onLog=this.logEmitter.event,this.loopbackHandler=async e=>{try{const t=await this.bearer.call("callserverhttp",{path:"/vscode-remote-resource?"+new URLSearchParams({path:e.uri.path}),method:e.method,headers:e.headers}),n=new ArrayBuffer(t.body.length);return new Uint8Array(n).set(t.body),{status:t.status,body:n,headers:t.headers}}catch(e){return{status:500,headers:{},body:(new TextEncoder).encode(e.message).buffer}}},this.bearer=new ue(e.basis,e.tunnel,e.port),this.onStartConnecting=this.bearer.onStartConnecting,this.onClose=this.bearer.onClose,this.bearer.onNotification("serverlog",(e=>{this.logEmitter.fire(e)}));let t=!0;this.bearer.onNotification("servermsg",(()=>{t&&(this.connectedEmitter.fire(),t=!1)}))}get tunnel(){return this.options.tunnel}getWebSocket(e){let t=new m({socketId:this.socketId++,url:e,bearer:this.bearer,product:this.options.productInfo,extensions:this.options.installExtensionsOnRemote});return t.initialize(),t}async getServerWebSocket(){let e=new f({socketId:this.socketId++,bearer:this.bearer,product:this.options.productInfo,extensions:this.options.installExtensionsOnRemote});return await e.initialize(),e}checkForUpdates(e){return this.bearer.call("update",{do_update:e?.doUpdate??!1})}async call(e,t){return this.bearer.call(e,t)}}class he extends ie{constructor(e){super("Local Proxy Server"),this.socket=e,this.acquire()}async call(e,t){return await super.call(e,t)}registerRequestHandler(e,t){return super.registerRequestHandler(e,t)}onNotification(e,t){return super.onNotification(e,t)}async notify(e,t){return await super.notify(e,t)}async getConnectionTunnel(){return this.socket}encodeToTunnel(e,t){e.write(M(t))}}const de=e=>`${e}.internal.stateChange`,pe=e=>`${e}.internal.call`;class fe{constructor(e,t){this.extensionId=e,this.commands=t,this.startEmitter=new d,this.closeEmitter=new d,this.connectedEmitter=new d,this.logEmitter=new d,this.onStartConnecting=this.startEmitter.event,this.onClose=this.closeEmitter.event,this.onConnected=this.connectedEmitter.event,this.onLog=this.logEmitter.event,t.registerCommand(de(e),(e=>{switch(e.state){case 2:this.startEmitter.fire();break;case 1:this.connectedEmitter.fire();break;case 0:this.closeEmitter.fire(e.reason);break;case 3:this.logEmitter.fire(e.line)}}))}static commands(e,t,n){return t.onClose((t=>n(de(e),{state:0,reason:t}).catch((()=>{})))),t.onConnected((()=>n(de(e),{state:1}).catch((()=>{})))),t.onStartConnecting((()=>n(de(e),{state:1}).catch((()=>{})))),t.onLog((t=>n(de(e),{state:3,line:t}).catch((()=>{})))),[{id:pe(e),handler:t.call.bind(t)}]}async call(e,t){return await this.commands.executeCommand(pe(this.extensionId),e,t)}}function me(e){if(e.tags?.includes("vscode-server-launcher"))return 2===e.tags?.length?e.tags.find((e=>"vscode-server-launcher"!==e)):e.name||e.tunnelId}async function ge({userAgent:e,name:t,sessions:n}){const r=await ve({lookup:t,userAgent:e,getTunnel:async(e,t)=>e.getTunnelForTag(t),lookupToString:e=>e,sessions:n});return void 0!==r?r:ye({userAgent:e,sessions:n,tunnel:{name:t}})}async function ye({userAgent:e,tunnel:t,sessions:n}){return ve({lookup:t,userAgent:e,getTunnel:async(e,t)=>e.getTunnel(t),lookupToString:e=>e.name||e.tunnelId,sessions:n})}async function ve({lookup:e,userAgent:t,getTunnel:n,lookupToString:r,sessions:o}){const s=`tunneling-${t}-auth-attempted`,i=`tunneling-${t}-session-${r(e)}`,a=localStorage.getItem(i);if(a){const r=o.find((e=>e.id===a));if(r){const o=new u(r.provider,t,(()=>r.getAccessToken()));try{const t=await n(o,e);if(t)return console.log("Reusing session from localStorage"),localStorage.removeItem(s),{client:o,session:r,tunnel:t};localStorage.removeItem(i)}catch(e){console.error(e)}}}const c=await(l=o.map((async r=>{if(r.id===a)return;const o=new u(r.provider,t,(()=>r.getAccessToken()));try{const t=await n(o,e);if(t)return{client:o,session:r,tunnel:t}}catch(e){console.error(e)}})),new Promise(((e,t)=>{let n=l.length;for(const r of l)r.then((t=>{n--,void 0===t&&0!==n||(e(t),n=-1)})).catch(t)})));var l;if(c)return localStorage.setItem(i,c.session.id),localStorage.removeItem(s),c;if(localStorage.getItem(s))throw localStorage.removeItem(s),new we(r(e));localStorage.setItem(s,"1")}class we extends Error{constructor(e){super(`Could not successfully authenticate into account that has access to ${e}. Please make sure you are logged into the correct account. You can reload and try again.`),this.tunnelIdentifier=e}}},9496:e=>{"use strict";e.exports=require("vscode")},9491:e=>{"use strict";e.exports=require("assert")},4300:e=>{"use strict";e.exports=require("buffer")},2057:e=>{"use strict";e.exports=require("constants")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},7564:e=>{"use strict";e.exports=JSON.parse('{"name":"@vs/tunnels-management","version":"1.0.7272","description":"Tunnels library for Visual Studio tools","keywords":["Tunnels"],"dependencies":{"buffer":"^5.2.1","debug":"^4.1.1","vscode-jsonrpc":"^4.0.0","@vs/tunnels-contracts":"^1.0.0","axios":"^0.21.1"},"author":"Microsoft","main":"./index.js"}')},9843:e=>{"use strict";e.exports=JSON.parse('{"name":"axios","version":"0.21.4","description":"Promise based HTTP client for the browser and node.js","main":"index.js","scripts":{"test":"grunt test","start":"node ./sandbox/server.js","build":"NODE_ENV=production grunt build","preversion":"npm test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json","postversion":"git push && git push --tags","examples":"node ./examples/server.js","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","fix":"eslint --fix lib/**/*.js"},"repository":{"type":"git","url":"https://github.com/axios/axios.git"},"keywords":["xhr","http","ajax","promise","node"],"author":"Matt Zabriskie","license":"MIT","bugs":{"url":"https://github.com/axios/axios/issues"},"homepage":"https://axios-http.com","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"jsdelivr":"dist/axios.min.js","unpkg":"dist/axios.min.js","typings":"./index.d.ts","dependencies":{"follow-redirects":"^1.14.0"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}]}')}},o={};function s(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={exports:{}};return r[e].call(n.exports,n,n.exports,s),n.exports}s.m=r,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"==typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"==typeof n.then)return n}var o=Object.create(null);s.r(o);var i={};e=e||[null,t({}),t([]),t(t)];for(var a=2&r&&n;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>i[e]=()=>n[e]));return i.default=()=>n,s.d(o,i),o},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,n)=>(s.f[n](e,t),t)),[])),s.u=e=>e+".js",s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n={898:1},s.f.require=(e,t)=>{n[e]||(e=>{var t=e.modules,r=e.ids,o=e.runtime;for(var i in t)s.o(t,i)&&(s.m[i]=t[i]);o&&o(s);for(var a=0;a<r.length;a++)n[r[a]]=1})(require("./"+s.u(e)))};var i=s(1122),a=exports;for(var c in i)a[c]=i[c];i.__esModule&&Object.defineProperty(a,"__esModule",{value:!0})})();